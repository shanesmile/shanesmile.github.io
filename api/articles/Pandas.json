{"title":"Pandas","slug":"Pandas","date":"2020-02-02T13:40:26.000Z","updated":"2020-11-10T08:52:30.709Z","comments":true,"path":"api/articles/Pandas.json","photos":[],"link":"","excerpt":"1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br># 它在Numpy的基础上，提供了一种高效的DataFrame数据结构，<br># 使得在Python中进行数据清洗和分析非常快捷。<br># Pandas采用了很多Numpy的代码风格，<br># 但最大的不同在于pandas主要用来处理表格型或异质型数据，<br># 而Numpy则相反，它更适合处理同质并且是数值类型的数据。<br># 通常我们会使用下面的国际惯例进行导入：<br># import pandas as pd<br># 有时候，我们也会将它包含的两个重要数据结构也单独导入：<br># from pandas import Series, DataFrame<br># 可以如下查看当前Pandas的版本信息：<br># pd.__version__<br>import pandas as pd<br>from pandas import Series,DataFrame<br>pd.__version__<br>'1.0.3'<br>","covers":null,"content":"<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 它在Numpy的基础上，提供了一种高效的DataFrame数据结构，</span></span><br><span class=\"line\"><span class=\"comment\"># 使得在Python中进行数据清洗和分析非常快捷。</span></span><br><span class=\"line\"><span class=\"comment\"># Pandas采用了很多Numpy的代码风格，</span></span><br><span class=\"line\"><span class=\"comment\"># 但最大的不同在于pandas主要用来处理表格型或异质型数据，</span></span><br><span class=\"line\"><span class=\"comment\"># 而Numpy则相反，它更适合处理同质并且是数值类型的数据。</span></span><br><span class=\"line\"><span class=\"comment\"># 通常我们会使用下面的国际惯例进行导入：</span></span><br><span class=\"line\"><span class=\"comment\"># import pandas as pd</span></span><br><span class=\"line\"><span class=\"comment\"># 有时候，我们也会将它包含的两个重要数据结构也单独导入：</span></span><br><span class=\"line\"><span class=\"comment\"># from pandas import Series, DataFrame</span></span><br><span class=\"line\"><span class=\"comment\"># 可以如下查看当前Pandas的版本信息：</span></span><br><span class=\"line\"><span class=\"comment\"># pd.__version__</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">from</span> pandas <span class=\"keyword\">import</span> Series,DataFrame</span><br><span class=\"line\">pd.__version__</span><br><span class=\"line\"><span class=\"string\">'1.0.3'</span></span><br></pre></td></tr></table></figure>\n\n<a id=\"more\"></a>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br><span class=\"line\">270</span><br><span class=\"line\">271</span><br><span class=\"line\">272</span><br><span class=\"line\">273</span><br><span class=\"line\">274</span><br><span class=\"line\">275</span><br><span class=\"line\">276</span><br><span class=\"line\">277</span><br><span class=\"line\">278</span><br><span class=\"line\">279</span><br><span class=\"line\">280</span><br><span class=\"line\">281</span><br><span class=\"line\">282</span><br><span class=\"line\">283</span><br><span class=\"line\">284</span><br><span class=\"line\">285</span><br><span class=\"line\">286</span><br><span class=\"line\">287</span><br><span class=\"line\">288</span><br><span class=\"line\">289</span><br><span class=\"line\">290</span><br><span class=\"line\">291</span><br><span class=\"line\">292</span><br><span class=\"line\">293</span><br><span class=\"line\">294</span><br><span class=\"line\">295</span><br><span class=\"line\">296</span><br><span class=\"line\">297</span><br><span class=\"line\">298</span><br><span class=\"line\">299</span><br><span class=\"line\">300</span><br><span class=\"line\">301</span><br><span class=\"line\">302</span><br><span class=\"line\">303</span><br><span class=\"line\">304</span><br><span class=\"line\">305</span><br><span class=\"line\">306</span><br><span class=\"line\">307</span><br><span class=\"line\">308</span><br><span class=\"line\">309</span><br><span class=\"line\">310</span><br><span class=\"line\">311</span><br><span class=\"line\">312</span><br><span class=\"line\">313</span><br><span class=\"line\">314</span><br><span class=\"line\">315</span><br><span class=\"line\">316</span><br><span class=\"line\">317</span><br><span class=\"line\">318</span><br><span class=\"line\">319</span><br><span class=\"line\">320</span><br><span class=\"line\">321</span><br><span class=\"line\">322</span><br><span class=\"line\">323</span><br><span class=\"line\">324</span><br><span class=\"line\">325</span><br><span class=\"line\">326</span><br><span class=\"line\">327</span><br><span class=\"line\">328</span><br><span class=\"line\">329</span><br><span class=\"line\">330</span><br><span class=\"line\">331</span><br><span class=\"line\">332</span><br><span class=\"line\">333</span><br><span class=\"line\">334</span><br><span class=\"line\">335</span><br><span class=\"line\">336</span><br><span class=\"line\">337</span><br><span class=\"line\">338</span><br><span class=\"line\">339</span><br><span class=\"line\">340</span><br><span class=\"line\">341</span><br><span class=\"line\">342</span><br><span class=\"line\">343</span><br><span class=\"line\">344</span><br><span class=\"line\">345</span><br><span class=\"line\">346</span><br><span class=\"line\">347</span><br><span class=\"line\">348</span><br><span class=\"line\">349</span><br><span class=\"line\">350</span><br><span class=\"line\">351</span><br><span class=\"line\">352</span><br><span class=\"line\">353</span><br><span class=\"line\">354</span><br><span class=\"line\">355</span><br><span class=\"line\">356</span><br><span class=\"line\">357</span><br><span class=\"line\">358</span><br><span class=\"line\">359</span><br><span class=\"line\">360</span><br><span class=\"line\">361</span><br><span class=\"line\">362</span><br><span class=\"line\">363</span><br><span class=\"line\">364</span><br><span class=\"line\">365</span><br><span class=\"line\">366</span><br><span class=\"line\">367</span><br><span class=\"line\">368</span><br><span class=\"line\">369</span><br><span class=\"line\">370</span><br><span class=\"line\">371</span><br><span class=\"line\">372</span><br><span class=\"line\">373</span><br><span class=\"line\">374</span><br><span class=\"line\">375</span><br><span class=\"line\">376</span><br><span class=\"line\">377</span><br><span class=\"line\">378</span><br><span class=\"line\">379</span><br><span class=\"line\">380</span><br><span class=\"line\">381</span><br><span class=\"line\">382</span><br><span class=\"line\">383</span><br><span class=\"line\">384</span><br><span class=\"line\">385</span><br><span class=\"line\">386</span><br><span class=\"line\">387</span><br><span class=\"line\">388</span><br><span class=\"line\">389</span><br><span class=\"line\">390</span><br><span class=\"line\">391</span><br><span class=\"line\">392</span><br><span class=\"line\">393</span><br><span class=\"line\">394</span><br><span class=\"line\">395</span><br><span class=\"line\">396</span><br><span class=\"line\">397</span><br><span class=\"line\">398</span><br><span class=\"line\">399</span><br><span class=\"line\">400</span><br><span class=\"line\">401</span><br><span class=\"line\">402</span><br><span class=\"line\">403</span><br><span class=\"line\">404</span><br><span class=\"line\">405</span><br><span class=\"line\">406</span><br><span class=\"line\">407</span><br><span class=\"line\">408</span><br><span class=\"line\">409</span><br><span class=\"line\">410</span><br><span class=\"line\">411</span><br><span class=\"line\">412</span><br><span class=\"line\">413</span><br><span class=\"line\">414</span><br><span class=\"line\">415</span><br><span class=\"line\">416</span><br><span class=\"line\">417</span><br><span class=\"line\">418</span><br><span class=\"line\">419</span><br><span class=\"line\">420</span><br><span class=\"line\">421</span><br><span class=\"line\">422</span><br><span class=\"line\">423</span><br><span class=\"line\">424</span><br><span class=\"line\">425</span><br><span class=\"line\">426</span><br><span class=\"line\">427</span><br><span class=\"line\">428</span><br><span class=\"line\">429</span><br><span class=\"line\">430</span><br><span class=\"line\">431</span><br><span class=\"line\">432</span><br><span class=\"line\">433</span><br><span class=\"line\">434</span><br><span class=\"line\">435</span><br><span class=\"line\">436</span><br><span class=\"line\">437</span><br><span class=\"line\">438</span><br><span class=\"line\">439</span><br><span class=\"line\">440</span><br><span class=\"line\">441</span><br><span class=\"line\">442</span><br><span class=\"line\">443</span><br><span class=\"line\">444</span><br><span class=\"line\">445</span><br><span class=\"line\">446</span><br><span class=\"line\">447</span><br><span class=\"line\">448</span><br><span class=\"line\">449</span><br><span class=\"line\">450</span><br><span class=\"line\">451</span><br><span class=\"line\">452</span><br><span class=\"line\">453</span><br><span class=\"line\">454</span><br><span class=\"line\">455</span><br><span class=\"line\">456</span><br><span class=\"line\">457</span><br><span class=\"line\">458</span><br><span class=\"line\">459</span><br><span class=\"line\">460</span><br><span class=\"line\">461</span><br><span class=\"line\">462</span><br><span class=\"line\">463</span><br><span class=\"line\">464</span><br><span class=\"line\">465</span><br><span class=\"line\">466</span><br><span class=\"line\">467</span><br><span class=\"line\">468</span><br><span class=\"line\">469</span><br><span class=\"line\">470</span><br><span class=\"line\">471</span><br><span class=\"line\">472</span><br><span class=\"line\">473</span><br><span class=\"line\">474</span><br><span class=\"line\">475</span><br><span class=\"line\">476</span><br><span class=\"line\">477</span><br><span class=\"line\">478</span><br><span class=\"line\">479</span><br><span class=\"line\">480</span><br><span class=\"line\">481</span><br><span class=\"line\">482</span><br><span class=\"line\">483</span><br><span class=\"line\">484</span><br><span class=\"line\">485</span><br><span class=\"line\">486</span><br><span class=\"line\">487</span><br><span class=\"line\">488</span><br><span class=\"line\">489</span><br><span class=\"line\">490</span><br><span class=\"line\">491</span><br><span class=\"line\">492</span><br><span class=\"line\">493</span><br><span class=\"line\">494</span><br><span class=\"line\">495</span><br><span class=\"line\">496</span><br><span class=\"line\">497</span><br><span class=\"line\">498</span><br><span class=\"line\">499</span><br><span class=\"line\">500</span><br><span class=\"line\">501</span><br><span class=\"line\">502</span><br><span class=\"line\">503</span><br><span class=\"line\">504</span><br><span class=\"line\">505</span><br><span class=\"line\">506</span><br><span class=\"line\">507</span><br><span class=\"line\">508</span><br><span class=\"line\">509</span><br><span class=\"line\">510</span><br><span class=\"line\">511</span><br><span class=\"line\">512</span><br><span class=\"line\">513</span><br><span class=\"line\">514</span><br><span class=\"line\">515</span><br><span class=\"line\">516</span><br><span class=\"line\">517</span><br><span class=\"line\">518</span><br><span class=\"line\">519</span><br><span class=\"line\">520</span><br><span class=\"line\">521</span><br><span class=\"line\">522</span><br><span class=\"line\">523</span><br><span class=\"line\">524</span><br><span class=\"line\">525</span><br><span class=\"line\">526</span><br><span class=\"line\">527</span><br><span class=\"line\">528</span><br><span class=\"line\">529</span><br><span class=\"line\">530</span><br><span class=\"line\">531</span><br><span class=\"line\">532</span><br><span class=\"line\">533</span><br><span class=\"line\">534</span><br><span class=\"line\">535</span><br><span class=\"line\">536</span><br><span class=\"line\">537</span><br><span class=\"line\">538</span><br><span class=\"line\">539</span><br><span class=\"line\">540</span><br><span class=\"line\">541</span><br><span class=\"line\">542</span><br><span class=\"line\">543</span><br><span class=\"line\">544</span><br><span class=\"line\">545</span><br><span class=\"line\">546</span><br><span class=\"line\">547</span><br><span class=\"line\">548</span><br><span class=\"line\">549</span><br><span class=\"line\">550</span><br><span class=\"line\">551</span><br><span class=\"line\">552</span><br><span class=\"line\">553</span><br><span class=\"line\">554</span><br><span class=\"line\">555</span><br><span class=\"line\">556</span><br><span class=\"line\">557</span><br><span class=\"line\">558</span><br><span class=\"line\">559</span><br><span class=\"line\">560</span><br><span class=\"line\">561</span><br><span class=\"line\">562</span><br><span class=\"line\">563</span><br><span class=\"line\">564</span><br><span class=\"line\">565</span><br><span class=\"line\">566</span><br><span class=\"line\">567</span><br><span class=\"line\">568</span><br><span class=\"line\">569</span><br><span class=\"line\">570</span><br><span class=\"line\">571</span><br><span class=\"line\">572</span><br><span class=\"line\">573</span><br><span class=\"line\">574</span><br><span class=\"line\">575</span><br><span class=\"line\">576</span><br><span class=\"line\">577</span><br><span class=\"line\">578</span><br><span class=\"line\">579</span><br><span class=\"line\">580</span><br><span class=\"line\">581</span><br><span class=\"line\">582</span><br><span class=\"line\">583</span><br><span class=\"line\">584</span><br><span class=\"line\">585</span><br><span class=\"line\">586</span><br><span class=\"line\">587</span><br><span class=\"line\">588</span><br><span class=\"line\">589</span><br><span class=\"line\">590</span><br><span class=\"line\">591</span><br><span class=\"line\">592</span><br><span class=\"line\">593</span><br><span class=\"line\">594</span><br><span class=\"line\">595</span><br><span class=\"line\">596</span><br><span class=\"line\">597</span><br><span class=\"line\">598</span><br><span class=\"line\">599</span><br><span class=\"line\">600</span><br><span class=\"line\">601</span><br><span class=\"line\">602</span><br><span class=\"line\">603</span><br><span class=\"line\">604</span><br><span class=\"line\">605</span><br><span class=\"line\">606</span><br><span class=\"line\">607</span><br><span class=\"line\">608</span><br><span class=\"line\">609</span><br><span class=\"line\">610</span><br><span class=\"line\">611</span><br><span class=\"line\">612</span><br><span class=\"line\">613</span><br><span class=\"line\">614</span><br><span class=\"line\">615</span><br><span class=\"line\">616</span><br><span class=\"line\">617</span><br><span class=\"line\">618</span><br><span class=\"line\">619</span><br><span class=\"line\">620</span><br><span class=\"line\">621</span><br><span class=\"line\">622</span><br><span class=\"line\">623</span><br><span class=\"line\">624</span><br><span class=\"line\">625</span><br><span class=\"line\">626</span><br><span class=\"line\">627</span><br><span class=\"line\">628</span><br><span class=\"line\">629</span><br><span class=\"line\">630</span><br><span class=\"line\">631</span><br><span class=\"line\">632</span><br><span class=\"line\">633</span><br><span class=\"line\">634</span><br><span class=\"line\">635</span><br><span class=\"line\">636</span><br><span class=\"line\">637</span><br><span class=\"line\">638</span><br><span class=\"line\">639</span><br><span class=\"line\">640</span><br><span class=\"line\">641</span><br><span class=\"line\">642</span><br><span class=\"line\">643</span><br><span class=\"line\">644</span><br><span class=\"line\">645</span><br><span class=\"line\">646</span><br><span class=\"line\">647</span><br><span class=\"line\">648</span><br><span class=\"line\">649</span><br><span class=\"line\">650</span><br><span class=\"line\">651</span><br><span class=\"line\">652</span><br><span class=\"line\">653</span><br><span class=\"line\">654</span><br><span class=\"line\">655</span><br><span class=\"line\">656</span><br><span class=\"line\">657</span><br><span class=\"line\">658</span><br><span class=\"line\">659</span><br><span class=\"line\">660</span><br><span class=\"line\">661</span><br><span class=\"line\">662</span><br><span class=\"line\">663</span><br><span class=\"line\">664</span><br><span class=\"line\">665</span><br><span class=\"line\">666</span><br><span class=\"line\">667</span><br><span class=\"line\">668</span><br><span class=\"line\">669</span><br><span class=\"line\">670</span><br><span class=\"line\">671</span><br><span class=\"line\">672</span><br><span class=\"line\">673</span><br><span class=\"line\">674</span><br><span class=\"line\">675</span><br><span class=\"line\">676</span><br><span class=\"line\">677</span><br><span class=\"line\">678</span><br><span class=\"line\">679</span><br><span class=\"line\">680</span><br><span class=\"line\">681</span><br><span class=\"line\">682</span><br><span class=\"line\">683</span><br><span class=\"line\">684</span><br><span class=\"line\">685</span><br><span class=\"line\">686</span><br><span class=\"line\">687</span><br><span class=\"line\">688</span><br><span class=\"line\">689</span><br><span class=\"line\">690</span><br><span class=\"line\">691</span><br><span class=\"line\">692</span><br><span class=\"line\">693</span><br><span class=\"line\">694</span><br><span class=\"line\">695</span><br><span class=\"line\">696</span><br><span class=\"line\">697</span><br><span class=\"line\">698</span><br><span class=\"line\">699</span><br><span class=\"line\">700</span><br><span class=\"line\">701</span><br><span class=\"line\">702</span><br><span class=\"line\">703</span><br><span class=\"line\">704</span><br><span class=\"line\">705</span><br><span class=\"line\">706</span><br><span class=\"line\">707</span><br><span class=\"line\">708</span><br><span class=\"line\">709</span><br><span class=\"line\">710</span><br><span class=\"line\">711</span><br><span class=\"line\">712</span><br><span class=\"line\">713</span><br><span class=\"line\">714</span><br><span class=\"line\">715</span><br><span class=\"line\">716</span><br><span class=\"line\">717</span><br><span class=\"line\">718</span><br><span class=\"line\">719</span><br><span class=\"line\">720</span><br><span class=\"line\">721</span><br><span class=\"line\">722</span><br><span class=\"line\">723</span><br><span class=\"line\">724</span><br><span class=\"line\">725</span><br><span class=\"line\">726</span><br><span class=\"line\">727</span><br><span class=\"line\">728</span><br><span class=\"line\">729</span><br><span class=\"line\">730</span><br><span class=\"line\">731</span><br><span class=\"line\">732</span><br><span class=\"line\">733</span><br><span class=\"line\">734</span><br><span class=\"line\">735</span><br><span class=\"line\">736</span><br><span class=\"line\">737</span><br><span class=\"line\">738</span><br><span class=\"line\">739</span><br><span class=\"line\">740</span><br><span class=\"line\">741</span><br><span class=\"line\">742</span><br><span class=\"line\">743</span><br><span class=\"line\">744</span><br><span class=\"line\">745</span><br><span class=\"line\">746</span><br><span class=\"line\">747</span><br><span class=\"line\">748</span><br><span class=\"line\">749</span><br><span class=\"line\">750</span><br><span class=\"line\">751</span><br><span class=\"line\">752</span><br><span class=\"line\">753</span><br><span class=\"line\">754</span><br><span class=\"line\">755</span><br><span class=\"line\">756</span><br><span class=\"line\">757</span><br><span class=\"line\">758</span><br><span class=\"line\">759</span><br><span class=\"line\">760</span><br><span class=\"line\">761</span><br><span class=\"line\">762</span><br><span class=\"line\">763</span><br><span class=\"line\">764</span><br><span class=\"line\">765</span><br><span class=\"line\">766</span><br><span class=\"line\">767</span><br><span class=\"line\">768</span><br><span class=\"line\">769</span><br><span class=\"line\">770</span><br><span class=\"line\">771</span><br><span class=\"line\">772</span><br><span class=\"line\">773</span><br><span class=\"line\">774</span><br><span class=\"line\">775</span><br><span class=\"line\">776</span><br><span class=\"line\">777</span><br><span class=\"line\">778</span><br><span class=\"line\">779</span><br><span class=\"line\">780</span><br><span class=\"line\">781</span><br><span class=\"line\">782</span><br><span class=\"line\">783</span><br><span class=\"line\">784</span><br><span class=\"line\">785</span><br><span class=\"line\">786</span><br><span class=\"line\">787</span><br><span class=\"line\">788</span><br><span class=\"line\">789</span><br><span class=\"line\">790</span><br><span class=\"line\">791</span><br><span class=\"line\">792</span><br><span class=\"line\">793</span><br><span class=\"line\">794</span><br><span class=\"line\">795</span><br><span class=\"line\">796</span><br><span class=\"line\">797</span><br><span class=\"line\">798</span><br><span class=\"line\">799</span><br><span class=\"line\">800</span><br><span class=\"line\">801</span><br><span class=\"line\">802</span><br><span class=\"line\">803</span><br><span class=\"line\">804</span><br><span class=\"line\">805</span><br><span class=\"line\">806</span><br><span class=\"line\">807</span><br><span class=\"line\">808</span><br><span class=\"line\">809</span><br><span class=\"line\">810</span><br><span class=\"line\">811</span><br><span class=\"line\">812</span><br><span class=\"line\">813</span><br><span class=\"line\">814</span><br><span class=\"line\">815</span><br><span class=\"line\">816</span><br><span class=\"line\">817</span><br><span class=\"line\">818</span><br><span class=\"line\">819</span><br><span class=\"line\">820</span><br><span class=\"line\">821</span><br><span class=\"line\">822</span><br><span class=\"line\">823</span><br><span class=\"line\">824</span><br><span class=\"line\">825</span><br><span class=\"line\">826</span><br><span class=\"line\">827</span><br><span class=\"line\">828</span><br><span class=\"line\">829</span><br><span class=\"line\">830</span><br><span class=\"line\">831</span><br><span class=\"line\">832</span><br><span class=\"line\">833</span><br><span class=\"line\">834</span><br><span class=\"line\">835</span><br><span class=\"line\">836</span><br><span class=\"line\">837</span><br><span class=\"line\">838</span><br><span class=\"line\">839</span><br><span class=\"line\">840</span><br><span class=\"line\">841</span><br><span class=\"line\">842</span><br><span class=\"line\">843</span><br><span class=\"line\">844</span><br><span class=\"line\">845</span><br><span class=\"line\">846</span><br><span class=\"line\">847</span><br><span class=\"line\">848</span><br><span class=\"line\">849</span><br><span class=\"line\">850</span><br><span class=\"line\">851</span><br><span class=\"line\">852</span><br><span class=\"line\">853</span><br><span class=\"line\">854</span><br><span class=\"line\">855</span><br><span class=\"line\">856</span><br><span class=\"line\">857</span><br><span class=\"line\">858</span><br><span class=\"line\">859</span><br><span class=\"line\">860</span><br><span class=\"line\">861</span><br><span class=\"line\">862</span><br><span class=\"line\">863</span><br><span class=\"line\">864</span><br><span class=\"line\">865</span><br><span class=\"line\">866</span><br><span class=\"line\">867</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Pandas的核心是三大数据结构：Series、DataFrame和Index。</span></span><br><span class=\"line\"><span class=\"comment\"># 绝大多数操作都是围绕这三种结构进行的。</span></span><br><span class=\"line\"><span class=\"comment\"># Series是一个一维的数组对象，</span></span><br><span class=\"line\"><span class=\"comment\"># 它包含一个值序列和一个对应的索引序列。</span></span><br><span class=\"line\"><span class=\"comment\"># Numpy的一维数组通过隐式定义的整数索引获取元素值，</span></span><br><span class=\"line\"><span class=\"comment\"># 而Series用一种显式定义的索引与元素关联。</span></span><br><span class=\"line\"><span class=\"comment\"># 显式索引让Series对象拥有更强的能力，</span></span><br><span class=\"line\"><span class=\"comment\"># 索引也不再仅仅是整数，还可以是别的类型，比如字符串，</span></span><br><span class=\"line\"><span class=\"comment\"># 索引也不需要连续，也可以重复，自由度非常高。</span></span><br><span class=\"line\">s = pd.Series([<span class=\"number\">7</span>,<span class=\"number\">-3</span>,<span class=\"number\">4</span>,<span class=\"number\">-1</span>])</span><br><span class=\"line\">s</span><br><span class=\"line\"><span class=\"number\">0</span>    <span class=\"number\">7</span></span><br><span class=\"line\"><span class=\"number\">1</span>   <span class=\"number\">-3</span></span><br><span class=\"line\"><span class=\"number\">2</span>    <span class=\"number\">4</span></span><br><span class=\"line\"><span class=\"number\">3</span>   <span class=\"number\">-1</span></span><br><span class=\"line\">dtype: int64</span><br><span class=\"line\"><span class=\"comment\"># 不是的type（）！！！！没有括号</span></span><br><span class=\"line\">s.dtype</span><br><span class=\"line\">dtype(<span class=\"string\">'int64'</span>)</span><br><span class=\"line\">s.values</span><br><span class=\"line\">array([ <span class=\"number\">7</span>, <span class=\"number\">-3</span>,  <span class=\"number\">4</span>, <span class=\"number\">-1</span>], dtype=int64)</span><br><span class=\"line\">s.index</span><br><span class=\"line\">RangeIndex(start=<span class=\"number\">0</span>, stop=<span class=\"number\">4</span>, step=<span class=\"number\">1</span>)</span><br><span class=\"line\"><span class=\"comment\"># 指定索引</span></span><br><span class=\"line\">s2 = pd.Series([<span class=\"number\">7</span>,<span class=\"number\">-3</span>,<span class=\"number\">4</span>,<span class=\"number\">-2</span>], index=[<span class=\"string\">'d'</span>,<span class=\"string\">'b'</span>,<span class=\"string\">'a'</span>,<span class=\"string\">'c'</span>])</span><br><span class=\"line\">s2</span><br><span class=\"line\">d    <span class=\"number\">7</span></span><br><span class=\"line\">b   <span class=\"number\">-3</span></span><br><span class=\"line\">a    <span class=\"number\">4</span></span><br><span class=\"line\">c   <span class=\"number\">-2</span></span><br><span class=\"line\">dtype: int64</span><br><span class=\"line\">s2.index</span><br><span class=\"line\">Index([<span class=\"string\">'d'</span>, <span class=\"string\">'b'</span>, <span class=\"string\">'a'</span>, <span class=\"string\">'c'</span>], dtype=<span class=\"string\">'object'</span>)</span><br><span class=\"line\">pd.Series(<span class=\"number\">5</span>,index=list(<span class=\"string\">'abcde'</span>))</span><br><span class=\"line\">a    <span class=\"number\">5</span></span><br><span class=\"line\">b    <span class=\"number\">5</span></span><br><span class=\"line\">c    <span class=\"number\">5</span></span><br><span class=\"line\">d    <span class=\"number\">5</span></span><br><span class=\"line\">e    <span class=\"number\">5</span></span><br><span class=\"line\">dtype: int64</span><br><span class=\"line\"><span class=\"comment\"># 通过index筛选结果</span></span><br><span class=\"line\">pd.Series(&#123;<span class=\"number\">2</span>:<span class=\"string\">'a'</span>,<span class=\"number\">1</span>:<span class=\"string\">'b'</span>,<span class=\"number\">3</span>:<span class=\"string\">'c'</span>&#125;)</span><br><span class=\"line\"><span class=\"number\">2</span>    a</span><br><span class=\"line\"><span class=\"number\">1</span>    b</span><br><span class=\"line\"><span class=\"number\">3</span>    c</span><br><span class=\"line\">dtype: object</span><br><span class=\"line\">pd.Series(&#123;<span class=\"number\">2</span>:<span class=\"string\">'a'</span>,<span class=\"number\">1</span>:<span class=\"string\">'b'</span>,<span class=\"number\">3</span>:<span class=\"string\">'c'</span>&#125;,index=[<span class=\"number\">3</span>,<span class=\"number\">2</span>])</span><br><span class=\"line\"><span class=\"number\">3</span>    c</span><br><span class=\"line\"><span class=\"number\">2</span>    a</span><br><span class=\"line\">dtype: object</span><br><span class=\"line\">s</span><br><span class=\"line\"><span class=\"number\">0</span>    <span class=\"number\">7</span></span><br><span class=\"line\"><span class=\"number\">1</span>   <span class=\"number\">-3</span></span><br><span class=\"line\"><span class=\"number\">2</span>    <span class=\"number\">4</span></span><br><span class=\"line\"><span class=\"number\">3</span>   <span class=\"number\">-1</span></span><br><span class=\"line\">dtype: int64</span><br><span class=\"line\"><span class=\"comment\"># 直接修改index</span></span><br><span class=\"line\">s.index = [<span class=\"string\">'a'</span>,<span class=\"string\">'b'</span>,<span class=\"string\">'c'</span>,<span class=\"string\">'d'</span>]</span><br><span class=\"line\">s</span><br><span class=\"line\">a    <span class=\"number\">7</span></span><br><span class=\"line\">b   <span class=\"number\">-3</span></span><br><span class=\"line\">c    <span class=\"number\">4</span></span><br><span class=\"line\">d   <span class=\"number\">-1</span></span><br><span class=\"line\">dtype: int64</span><br><span class=\"line\">s[<span class=\"string\">'a'</span>]</span><br><span class=\"line\"><span class=\"number\">7</span></span><br><span class=\"line\">s2</span><br><span class=\"line\">d    <span class=\"number\">7</span></span><br><span class=\"line\">b   <span class=\"number\">-3</span></span><br><span class=\"line\">a    <span class=\"number\">4</span></span><br><span class=\"line\">c   <span class=\"number\">-2</span></span><br><span class=\"line\">dtype: int64</span><br><span class=\"line\"><span class=\"comment\"># 取多个时加中括号</span></span><br><span class=\"line\">s2[[<span class=\"string\">'a'</span>,<span class=\"string\">'c'</span>,<span class=\"string\">'b'</span>]]</span><br><span class=\"line\">a    <span class=\"number\">4</span></span><br><span class=\"line\">c   <span class=\"number\">-2</span></span><br><span class=\"line\">b   <span class=\"number\">-3</span></span><br><span class=\"line\">dtype: int64</span><br><span class=\"line\">s2[s2&gt;<span class=\"number\">0</span>]</span><br><span class=\"line\">d    <span class=\"number\">7</span></span><br><span class=\"line\">a    <span class=\"number\">4</span></span><br><span class=\"line\">dtype: int64</span><br><span class=\"line\"><span class=\"comment\"># 因为索引可以是字符串，所以从某个角度看，</span></span><br><span class=\"line\"><span class=\"comment\"># Series又比较类似Python的有序字典，所以可以使用in操作</span></span><br><span class=\"line\"><span class=\"string\">'b'</span> <span class=\"keyword\">in</span> s2</span><br><span class=\"line\"><span class=\"literal\">True</span></span><br><span class=\"line\"><span class=\"comment\"># 通过字典创建Series</span></span><br><span class=\"line\">dic = &#123;<span class=\"string\">'beijing'</span>:<span class=\"number\">35000</span>,<span class=\"string\">'shanghai'</span>:<span class=\"number\">71000</span>,<span class=\"string\">'guangzhou'</span>:<span class=\"number\">16000</span>,<span class=\"string\">'shenzhen'</span>:<span class=\"number\">5000</span>&#125;</span><br><span class=\"line\">s3 = pd.Series(dic)</span><br><span class=\"line\">s3</span><br><span class=\"line\">beijing      <span class=\"number\">35000</span></span><br><span class=\"line\">shanghai     <span class=\"number\">71000</span></span><br><span class=\"line\">guangzhou    <span class=\"number\">16000</span></span><br><span class=\"line\">shenzhen      <span class=\"number\">5000</span></span><br><span class=\"line\">dtype: int64</span><br><span class=\"line\"><span class=\"comment\"># 使用类似字典的方式时，要有括号，但s.index不要</span></span><br><span class=\"line\">s3.keys()</span><br><span class=\"line\">Index([<span class=\"string\">'beijing'</span>, <span class=\"string\">'shanghai'</span>, <span class=\"string\">'guangzhou'</span>, <span class=\"string\">'shenzhen'</span>], dtype=<span class=\"string\">'object'</span>)</span><br><span class=\"line\">s3.items()</span><br><span class=\"line\">&lt;zip at <span class=\"number\">0x2db0c93eec8</span>&gt;</span><br><span class=\"line\">type(s3.items())</span><br><span class=\"line\">zip</span><br><span class=\"line\">list(s3.items())</span><br><span class=\"line\">[(<span class=\"string\">'beijing'</span>, <span class=\"number\">35000</span>),</span><br><span class=\"line\"> (<span class=\"string\">'shanghai'</span>, <span class=\"number\">71000</span>),</span><br><span class=\"line\"> (<span class=\"string\">'guangzhou'</span>, <span class=\"number\">16000</span>),</span><br><span class=\"line\"> (<span class=\"string\">'shenzhen'</span>, <span class=\"number\">5000</span>)]</span><br><span class=\"line\">s3[<span class=\"string\">'beijing'</span>]</span><br><span class=\"line\"><span class=\"number\">35000</span></span><br><span class=\"line\">city = [<span class=\"string\">'nanjing'</span>, <span class=\"string\">'shanghai'</span>,<span class=\"string\">'guangzhou'</span>,<span class=\"string\">'beijing'</span>]</span><br><span class=\"line\">dic = &#123;<span class=\"string\">'beijing'</span>:<span class=\"number\">35000</span>,<span class=\"string\">'shanghai'</span>:<span class=\"number\">71000</span>,<span class=\"string\">'guangzhou'</span>:<span class=\"number\">16000</span>,<span class=\"string\">'shenzhen'</span>:<span class=\"number\">5000</span>&#125;</span><br><span class=\"line\"><span class=\"comment\"># dic中已经有索引了，再加一个city列表多此一举</span></span><br><span class=\"line\"><span class=\"comment\"># 以下例子在有索引的下的情况验证新的index</span></span><br><span class=\"line\">s4=pd.Series(dic, index=city)</span><br><span class=\"line\"><span class=\"comment\"># 发现nanjing自动设为NaN，因为原索引中没有，而少了shenzheng，因为设置的index中没有</span></span><br><span class=\"line\">s4</span><br><span class=\"line\">nanjing          NaN</span><br><span class=\"line\">shanghai     <span class=\"number\">71000.0</span></span><br><span class=\"line\">guangzhou    <span class=\"number\">16000.0</span></span><br><span class=\"line\">beijing      <span class=\"number\">35000.0</span></span><br><span class=\"line\">dtype: float64</span><br><span class=\"line\"><span class=\"comment\"># isnull()和notnull()函数来检查缺失的数据</span></span><br><span class=\"line\">pd.isnull(s4)</span><br><span class=\"line\">nanjing       <span class=\"literal\">True</span></span><br><span class=\"line\">shanghai     <span class=\"literal\">False</span></span><br><span class=\"line\">guangzhou    <span class=\"literal\">False</span></span><br><span class=\"line\">beijing      <span class=\"literal\">False</span></span><br><span class=\"line\">dtype: bool</span><br><span class=\"line\">pd.notnull(s4)</span><br><span class=\"line\">nanjing      <span class=\"literal\">False</span></span><br><span class=\"line\">shanghai      <span class=\"literal\">True</span></span><br><span class=\"line\">guangzhou     <span class=\"literal\">True</span></span><br><span class=\"line\">beijing       <span class=\"literal\">True</span></span><br><span class=\"line\">dtype: bool</span><br><span class=\"line\">s4.isnull()</span><br><span class=\"line\">nanjing       <span class=\"literal\">True</span></span><br><span class=\"line\">shanghai     <span class=\"literal\">False</span></span><br><span class=\"line\">guangzhou    <span class=\"literal\">False</span></span><br><span class=\"line\">beijing      <span class=\"literal\">False</span></span><br><span class=\"line\">dtype: bool</span><br><span class=\"line\"><span class=\"comment\"># 为Series对象和其索引设置name属性</span></span><br><span class=\"line\">s4.name=<span class=\"string\">'people'</span></span><br><span class=\"line\">s4.index.name=<span class=\"string\">'city'</span></span><br><span class=\"line\">s4</span><br><span class=\"line\">city</span><br><span class=\"line\">nanjing          NaN</span><br><span class=\"line\">shanghai     <span class=\"number\">71000.0</span></span><br><span class=\"line\">guangzhou    <span class=\"number\">16000.0</span></span><br><span class=\"line\">beijing      <span class=\"number\">35000.0</span></span><br><span class=\"line\">Name: people, dtype: float64</span><br><span class=\"line\">s4.index</span><br><span class=\"line\">Index([<span class=\"string\">'nanjing'</span>, <span class=\"string\">'shanghai'</span>, <span class=\"string\">'guangzhou'</span>, <span class=\"string\">'beijing'</span>], dtype=<span class=\"string\">'object'</span>, name=<span class=\"string\">'city'</span>)</span><br><span class=\"line\"><span class=\"comment\"># DataFrame是Pandas的核心数据结构，</span></span><br><span class=\"line\"><span class=\"comment\"># 表示的是二维的矩阵数据表，类似关系型数据库的结构，</span></span><br><span class=\"line\"><span class=\"comment\"># 每一列可以是不同的值类型，比如数值、字符串、布尔值等等。</span></span><br><span class=\"line\"><span class=\"comment\"># DataFrame既有行索引，也有列索引，它可以被看做为一个共享相同索引的Series的字典。</span></span><br><span class=\"line\">data = &#123;<span class=\"string\">'state'</span>:[<span class=\"string\">'beijing'</span>,<span class=\"string\">'beijing'</span>,<span class=\"string\">'beijign'</span>,<span class=\"string\">'shanghai'</span>,<span class=\"string\">'shanghai'</span>,<span class=\"string\">'shanghai'</span>],</span><br><span class=\"line\">        <span class=\"string\">'year'</span>:[<span class=\"number\">2000</span>,<span class=\"number\">2001</span>,<span class=\"number\">2002</span>,<span class=\"number\">2001</span>,<span class=\"number\">2002</span>,<span class=\"number\">2003</span>],</span><br><span class=\"line\">        <span class=\"string\">'pop'</span>:[<span class=\"number\">1.5</span>, <span class=\"number\">1.7</span>,<span class=\"number\">3.6</span>,<span class=\"number\">2.4</span>,<span class=\"number\">2.9</span>,<span class=\"number\">3.2</span>]</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">data</span><br><span class=\"line\">&#123;<span class=\"string\">'state'</span>: [<span class=\"string\">'beijing'</span>,</span><br><span class=\"line\">  <span class=\"string\">'beijing'</span>,</span><br><span class=\"line\">  <span class=\"string\">'beijign'</span>,</span><br><span class=\"line\">  <span class=\"string\">'shanghai'</span>,</span><br><span class=\"line\">  <span class=\"string\">'shanghai'</span>,</span><br><span class=\"line\">  <span class=\"string\">'shanghai'</span>],</span><br><span class=\"line\"> <span class=\"string\">'year'</span>: [<span class=\"number\">2000</span>, <span class=\"number\">2001</span>, <span class=\"number\">2002</span>, <span class=\"number\">2001</span>, <span class=\"number\">2002</span>, <span class=\"number\">2003</span>],</span><br><span class=\"line\"> <span class=\"string\">'pop'</span>: [<span class=\"number\">1.5</span>, <span class=\"number\">1.7</span>, <span class=\"number\">3.6</span>, <span class=\"number\">2.4</span>, <span class=\"number\">2.9</span>, <span class=\"number\">3.2</span>]&#125;</span><br><span class=\"line\">f = pd.DataFrame(data)</span><br><span class=\"line\">f</span><br><span class=\"line\">state\tyear\tpop</span><br><span class=\"line\"><span class=\"number\">0</span>\tbeijing\t<span class=\"number\">2000</span>\t<span class=\"number\">1.5</span></span><br><span class=\"line\"><span class=\"number\">1</span>\tbeijing\t<span class=\"number\">2001</span>\t<span class=\"number\">1.7</span></span><br><span class=\"line\"><span class=\"number\">2</span>\tbeijign\t<span class=\"number\">2002</span>\t<span class=\"number\">3.6</span></span><br><span class=\"line\"><span class=\"number\">3</span>\tshanghai\t<span class=\"number\">2001</span>\t<span class=\"number\">2.4</span></span><br><span class=\"line\"><span class=\"number\">4</span>\tshanghai\t<span class=\"number\">2002</span>\t<span class=\"number\">2.9</span></span><br><span class=\"line\"><span class=\"number\">5</span>\tshanghai\t<span class=\"number\">2003</span>\t<span class=\"number\">3.2</span></span><br><span class=\"line\"><span class=\"comment\"># 属性index、dtypes、columns、values等无小括号</span></span><br><span class=\"line\">f.columns</span><br><span class=\"line\">Index([<span class=\"string\">'state'</span>, <span class=\"string\">'year'</span>, <span class=\"string\">'pop'</span>], dtype=<span class=\"string\">'object'</span>)</span><br><span class=\"line\">f.dtypes</span><br><span class=\"line\">state     object</span><br><span class=\"line\">year       int64</span><br><span class=\"line\">pop      float64</span><br><span class=\"line\">dtype: object</span><br><span class=\"line\"><span class=\"comment\"># 按行查看</span></span><br><span class=\"line\">f.values</span><br><span class=\"line\">array([[<span class=\"string\">'beijing'</span>, <span class=\"number\">2000</span>, <span class=\"number\">1.5</span>],</span><br><span class=\"line\">       [<span class=\"string\">'beijing'</span>, <span class=\"number\">2001</span>, <span class=\"number\">1.7</span>],</span><br><span class=\"line\">       [<span class=\"string\">'beijign'</span>, <span class=\"number\">2002</span>, <span class=\"number\">3.6</span>],</span><br><span class=\"line\">       [<span class=\"string\">'shanghai'</span>, <span class=\"number\">2001</span>, <span class=\"number\">2.4</span>],</span><br><span class=\"line\">       [<span class=\"string\">'shanghai'</span>, <span class=\"number\">2002</span>, <span class=\"number\">2.9</span>],</span><br><span class=\"line\">       [<span class=\"string\">'shanghai'</span>, <span class=\"number\">2003</span>, <span class=\"number\">3.2</span>]], dtype=object)</span><br><span class=\"line\">f.head() <span class=\"comment\"># 默认前五行</span></span><br><span class=\"line\">state\tyear\tpop</span><br><span class=\"line\"><span class=\"number\">0</span>\tbeijing\t<span class=\"number\">2000</span>\t<span class=\"number\">1.5</span></span><br><span class=\"line\"><span class=\"number\">1</span>\tbeijing\t<span class=\"number\">2001</span>\t<span class=\"number\">1.7</span></span><br><span class=\"line\"><span class=\"number\">2</span>\tbeijign\t<span class=\"number\">2002</span>\t<span class=\"number\">3.6</span></span><br><span class=\"line\"><span class=\"number\">3</span>\tshanghai\t<span class=\"number\">2001</span>\t<span class=\"number\">2.4</span></span><br><span class=\"line\"><span class=\"number\">4</span>\tshanghai\t<span class=\"number\">2002</span>\t<span class=\"number\">2.9</span></span><br><span class=\"line\">f.head(<span class=\"number\">3</span>)</span><br><span class=\"line\">state\tyear\tpop</span><br><span class=\"line\"><span class=\"number\">0</span>\tbeijing\t<span class=\"number\">2000</span>\t<span class=\"number\">1.5</span></span><br><span class=\"line\"><span class=\"number\">1</span>\tbeijing\t<span class=\"number\">2001</span>\t<span class=\"number\">1.7</span></span><br><span class=\"line\"><span class=\"number\">2</span>\tbeijign\t<span class=\"number\">2002</span>\t<span class=\"number\">3.6</span></span><br><span class=\"line\">f.tail()</span><br><span class=\"line\">state\tyear\tpop</span><br><span class=\"line\"><span class=\"number\">1</span>\tbeijing\t<span class=\"number\">2001</span>\t<span class=\"number\">1.7</span></span><br><span class=\"line\"><span class=\"number\">2</span>\tbeijign\t<span class=\"number\">2002</span>\t<span class=\"number\">3.6</span></span><br><span class=\"line\"><span class=\"number\">3</span>\tshanghai\t<span class=\"number\">2001</span>\t<span class=\"number\">2.4</span></span><br><span class=\"line\"><span class=\"number\">4</span>\tshanghai\t<span class=\"number\">2002</span>\t<span class=\"number\">2.9</span></span><br><span class=\"line\"><span class=\"number\">5</span>\tshanghai\t<span class=\"number\">2003</span>\t<span class=\"number\">3.2</span></span><br><span class=\"line\">f.tail(<span class=\"number\">2</span>)</span><br><span class=\"line\">state\tyear\tpop</span><br><span class=\"line\"><span class=\"number\">4</span>\tshanghai\t<span class=\"number\">2002</span>\t<span class=\"number\">2.9</span></span><br><span class=\"line\"><span class=\"number\">5</span>\tshanghai\t<span class=\"number\">2003</span>\t<span class=\"number\">3.2</span></span><br><span class=\"line\"><span class=\"comment\"># DataFrame对象中的state/year/pop，其实就是列索引，</span></span><br><span class=\"line\"><span class=\"comment\"># 可以在创建的时候使用参数名columns指定它们的先后顺序</span></span><br><span class=\"line\">pd.DataFrame(data,columns=[<span class=\"string\">'year'</span>,<span class=\"string\">'state'</span>,<span class=\"string\">'pop'</span>])</span><br><span class=\"line\">year\tstate\tpop</span><br><span class=\"line\"><span class=\"number\">0</span>\t<span class=\"number\">2000</span>\tbeijing\t<span class=\"number\">1.5</span></span><br><span class=\"line\"><span class=\"number\">1</span>\t<span class=\"number\">2001</span>\tbeijing\t<span class=\"number\">1.7</span></span><br><span class=\"line\"><span class=\"number\">2</span>\t<span class=\"number\">2002</span>\tbeijign\t<span class=\"number\">3.6</span></span><br><span class=\"line\"><span class=\"number\">3</span>\t<span class=\"number\">2001</span>\tshanghai\t<span class=\"number\">2.4</span></span><br><span class=\"line\"><span class=\"number\">4</span>\t<span class=\"number\">2002</span>\tshanghai\t<span class=\"number\">2.9</span></span><br><span class=\"line\"><span class=\"number\">5</span>\t<span class=\"number\">2003</span>\tshanghai\t<span class=\"number\">3.2</span></span><br><span class=\"line\"><span class=\"comment\"># columns列索引，index行索引</span></span><br><span class=\"line\">f2 = pd.DataFrame(data,columns=[<span class=\"string\">'year'</span>,<span class=\"string\">'state'</span>,<span class=\"string\">'pop'</span>], index=[<span class=\"string\">'a'</span>,<span class=\"string\">'b'</span>,<span class=\"string\">'c'</span>,<span class=\"string\">'d'</span>,<span class=\"string\">'e'</span>,<span class=\"string\">'f'</span>])</span><br><span class=\"line\">f2</span><br><span class=\"line\">year\tstate\tpop</span><br><span class=\"line\">a\t<span class=\"number\">2000</span>\tbeijing\t<span class=\"number\">1.5</span></span><br><span class=\"line\">b\t<span class=\"number\">2001</span>\tbeijing\t<span class=\"number\">1.7</span></span><br><span class=\"line\">c\t<span class=\"number\">2002</span>\tbeijign\t<span class=\"number\">3.6</span></span><br><span class=\"line\">d\t<span class=\"number\">2001</span>\tshanghai\t<span class=\"number\">2.4</span></span><br><span class=\"line\">e\t<span class=\"number\">2002</span>\tshanghai\t<span class=\"number\">2.9</span></span><br><span class=\"line\">f\t<span class=\"number\">2003</span>\tshanghai\t<span class=\"number\">3.2</span></span><br><span class=\"line\">f2[<span class=\"string\">'year'</span>]</span><br><span class=\"line\">a    <span class=\"number\">2000</span></span><br><span class=\"line\">b    <span class=\"number\">2001</span></span><br><span class=\"line\">c    <span class=\"number\">2002</span></span><br><span class=\"line\">d    <span class=\"number\">2001</span></span><br><span class=\"line\">e    <span class=\"number\">2002</span></span><br><span class=\"line\">f    <span class=\"number\">2003</span></span><br><span class=\"line\">Name: year, dtype: int64</span><br><span class=\"line\"><span class=\"comment\"># 也可以用属性形式索引，但这种方法bug</span></span><br><span class=\"line\"><span class=\"comment\"># 比如属性名不是纯字符串，或者与其他方法同名</span></span><br><span class=\"line\">f2.year</span><br><span class=\"line\">a    <span class=\"number\">2000</span></span><br><span class=\"line\">b    <span class=\"number\">2001</span></span><br><span class=\"line\">c    <span class=\"number\">2002</span></span><br><span class=\"line\">d    <span class=\"number\">2001</span></span><br><span class=\"line\">e    <span class=\"number\">2002</span></span><br><span class=\"line\">f    <span class=\"number\">2003</span></span><br><span class=\"line\">Name: year, dtype: int64</span><br><span class=\"line\"><span class=\"comment\"># 但是行索引并不是f2['a']这种形式，而是要通过一个loc方法</span></span><br><span class=\"line\">f2.loc[<span class=\"string\">'a'</span>]</span><br><span class=\"line\">year        <span class=\"number\">2000</span></span><br><span class=\"line\">state    beijing</span><br><span class=\"line\">pop          <span class=\"number\">1.5</span></span><br><span class=\"line\">Name: a, dtype: object</span><br><span class=\"line\"><span class=\"comment\"># 给DataFrame对象追加列</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\">f2[<span class=\"string\">'debt'</span>] = np.arange(<span class=\"number\">1</span>,<span class=\"number\">7</span>)</span><br><span class=\"line\">f2</span><br><span class=\"line\">year\tstate\tpop\tdebt</span><br><span class=\"line\">a\t<span class=\"number\">2000</span>\tbeijing\t<span class=\"number\">1.5</span>\t<span class=\"number\">1</span></span><br><span class=\"line\">b\t<span class=\"number\">2001</span>\tbeijing\t<span class=\"number\">1.7</span>\t<span class=\"number\">2</span></span><br><span class=\"line\">c\t<span class=\"number\">2002</span>\tbeijign\t<span class=\"number\">3.6</span>\t<span class=\"number\">3</span></span><br><span class=\"line\">d\t<span class=\"number\">2001</span>\tshanghai\t<span class=\"number\">2.4</span>\t<span class=\"number\">4</span></span><br><span class=\"line\">e\t<span class=\"number\">2002</span>\tshanghai\t<span class=\"number\">2.9</span>\t<span class=\"number\">5</span></span><br><span class=\"line\">f\t<span class=\"number\">2003</span>\tshanghai\t<span class=\"number\">3.2</span>\t<span class=\"number\">6</span></span><br><span class=\"line\">f2[<span class=\"string\">'lol'</span>] = [<span class=\"number\">2</span>,<span class=\"number\">1</span>,<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">1</span>,<span class=\"number\">2</span>]</span><br><span class=\"line\">f2</span><br><span class=\"line\">year\tstate\tpop\tdebt\tlol</span><br><span class=\"line\">a\t<span class=\"number\">2000</span>\tbeijing\t<span class=\"number\">1.5</span>\t<span class=\"number\">1</span>\t<span class=\"number\">2</span></span><br><span class=\"line\">b\t<span class=\"number\">2001</span>\tbeijing\t<span class=\"number\">1.7</span>\t<span class=\"number\">2</span>\t<span class=\"number\">1</span></span><br><span class=\"line\">c\t<span class=\"number\">2002</span>\tbeijign\t<span class=\"number\">3.6</span>\t<span class=\"number\">3</span>\t<span class=\"number\">1</span></span><br><span class=\"line\">d\t<span class=\"number\">2001</span>\tshanghai\t<span class=\"number\">2.4</span>\t<span class=\"number\">4</span>\t<span class=\"number\">2</span></span><br><span class=\"line\">e\t<span class=\"number\">2002</span>\tshanghai\t<span class=\"number\">2.9</span>\t<span class=\"number\">5</span>\t<span class=\"number\">1</span></span><br><span class=\"line\">f\t<span class=\"number\">2003</span>\tshanghai\t<span class=\"number\">3.2</span>\t<span class=\"number\">6</span>\t<span class=\"number\">2</span></span><br><span class=\"line\">val = pd.Series([<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>],index=[<span class=\"string\">'c'</span>,<span class=\"string\">'d'</span>,<span class=\"string\">'f'</span>])</span><br><span class=\"line\">val</span><br><span class=\"line\">c    <span class=\"number\">1</span></span><br><span class=\"line\">d    <span class=\"number\">2</span></span><br><span class=\"line\">f    <span class=\"number\">3</span></span><br><span class=\"line\">dtype: int64</span><br><span class=\"line\">f2[<span class=\"string\">'lol'</span>] = val</span><br><span class=\"line\">f2</span><br><span class=\"line\">year\tstate\tpop\tdebt\tlol</span><br><span class=\"line\">a\t<span class=\"number\">2000</span>\tbeijing\t<span class=\"number\">1.5</span>\t<span class=\"number\">1</span>\tNaN</span><br><span class=\"line\">b\t<span class=\"number\">2001</span>\tbeijing\t<span class=\"number\">1.7</span>\t<span class=\"number\">2</span>\tNaN</span><br><span class=\"line\">c\t<span class=\"number\">2002</span>\tbeijign\t<span class=\"number\">3.6</span>\t<span class=\"number\">3</span>\t<span class=\"number\">1.0</span></span><br><span class=\"line\">d\t<span class=\"number\">2001</span>\tshanghai\t<span class=\"number\">2.4</span>\t<span class=\"number\">4</span>\t<span class=\"number\">2.0</span></span><br><span class=\"line\">e\t<span class=\"number\">2002</span>\tshanghai\t<span class=\"number\">2.9</span>\t<span class=\"number\">5</span>\tNaN</span><br><span class=\"line\">f\t<span class=\"number\">2003</span>\tshanghai\t<span class=\"number\">3.2</span>\t<span class=\"number\">6</span>\t<span class=\"number\">3.0</span></span><br><span class=\"line\"><span class=\"comment\"># 增加行</span></span><br><span class=\"line\">df = pd.DataFrame(data,index=list(<span class=\"string\">'abcdef'</span>))</span><br><span class=\"line\">df</span><br><span class=\"line\">state\tyear\tpop</span><br><span class=\"line\">a\tbeijing\t<span class=\"number\">2000</span>\t<span class=\"number\">1.5</span></span><br><span class=\"line\">b\tbeijing\t<span class=\"number\">2001</span>\t<span class=\"number\">1.7</span></span><br><span class=\"line\">c\tbeijign\t<span class=\"number\">2002</span>\t<span class=\"number\">3.6</span></span><br><span class=\"line\">d\tshanghai\t<span class=\"number\">2001</span>\t<span class=\"number\">2.4</span></span><br><span class=\"line\">e\tshanghai\t<span class=\"number\">2002</span>\t<span class=\"number\">2.9</span></span><br><span class=\"line\">f\tshanghai\t<span class=\"number\">2003</span>\t<span class=\"number\">3.2</span></span><br><span class=\"line\">df1 = df.loc[<span class=\"string\">'a'</span>]</span><br><span class=\"line\">df1</span><br><span class=\"line\">state    beijing</span><br><span class=\"line\">year        <span class=\"number\">2000</span></span><br><span class=\"line\">pop          <span class=\"number\">1.5</span></span><br><span class=\"line\">Name: a, dtype: object</span><br><span class=\"line\">df.append(df1)</span><br><span class=\"line\">state\tyear\tpop</span><br><span class=\"line\">a\tbeijing\t<span class=\"number\">2000</span>\t<span class=\"number\">1.5</span></span><br><span class=\"line\">b\tbeijing\t<span class=\"number\">2001</span>\t<span class=\"number\">1.7</span></span><br><span class=\"line\">c\tbeijign\t<span class=\"number\">2002</span>\t<span class=\"number\">3.6</span></span><br><span class=\"line\">d\tshanghai\t<span class=\"number\">2001</span>\t<span class=\"number\">2.4</span></span><br><span class=\"line\">e\tshanghai\t<span class=\"number\">2002</span>\t<span class=\"number\">2.9</span></span><br><span class=\"line\">f\tshanghai\t<span class=\"number\">2003</span>\t<span class=\"number\">3.2</span></span><br><span class=\"line\">a\tbeijing\t<span class=\"number\">2000</span>\t<span class=\"number\">1.5</span></span><br><span class=\"line\">f2[<span class=\"string\">'new'</span>] = f2.state == <span class=\"string\">'beijing'</span></span><br><span class=\"line\">f2</span><br><span class=\"line\">year\tstate\tpop\tdebt\tlol\tnew</span><br><span class=\"line\">a\t<span class=\"number\">2000</span>\tbeijing\t<span class=\"number\">1.5</span>\t<span class=\"number\">1</span>\tNaN\t<span class=\"literal\">True</span></span><br><span class=\"line\">b\t<span class=\"number\">2001</span>\tbeijing\t<span class=\"number\">1.7</span>\t<span class=\"number\">2</span>\tNaN\t<span class=\"literal\">True</span></span><br><span class=\"line\">c\t<span class=\"number\">2002</span>\tbeijign\t<span class=\"number\">3.6</span>\t<span class=\"number\">3</span>\t<span class=\"number\">1.0</span>\t<span class=\"literal\">False</span></span><br><span class=\"line\">d\t<span class=\"number\">2001</span>\tshanghai\t<span class=\"number\">2.4</span>\t<span class=\"number\">4</span>\t<span class=\"number\">2.0</span>\t<span class=\"literal\">False</span></span><br><span class=\"line\">e\t<span class=\"number\">2002</span>\tshanghai\t<span class=\"number\">2.9</span>\t<span class=\"number\">5</span>\tNaN\t<span class=\"literal\">False</span></span><br><span class=\"line\">f\t<span class=\"number\">2003</span>\tshanghai\t<span class=\"number\">3.2</span>\t<span class=\"number\">6</span>\t<span class=\"number\">3.0</span>\t<span class=\"literal\">False</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">f2</span>.<span class=\"title\">lol</span></span></span><br><span class=\"line\">  File \"&lt;ipython-input-86-c347da38d0dd&gt;\", line 1</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">f2</span>.<span class=\"title\">lol</span></span></span><br><span class=\"line\"><span class=\"function\">          ^</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">SyntaxError</span>:</span> invalid syntax</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">del</span> f2[<span class=\"string\">'lol'</span>]</span><br><span class=\"line\">f2.columns</span><br><span class=\"line\">Index([<span class=\"string\">'year'</span>, <span class=\"string\">'state'</span>, <span class=\"string\">'pop'</span>, <span class=\"string\">'debt'</span>, <span class=\"string\">'new'</span>], dtype=<span class=\"string\">'object'</span>)</span><br><span class=\"line\"><span class=\"comment\"># 可以使用类似Numpy的T属性，将DataFrame进行转置</span></span><br><span class=\"line\">f2</span><br><span class=\"line\">year\tstate\tpop\tdebt\tnew</span><br><span class=\"line\">a\t<span class=\"number\">2000</span>\tbeijing\t<span class=\"number\">1.5</span>\t<span class=\"number\">1</span>\t<span class=\"literal\">True</span></span><br><span class=\"line\">b\t<span class=\"number\">2001</span>\tbeijing\t<span class=\"number\">1.7</span>\t<span class=\"number\">2</span>\t<span class=\"literal\">True</span></span><br><span class=\"line\">c\t<span class=\"number\">2002</span>\tbeijign\t<span class=\"number\">3.6</span>\t<span class=\"number\">3</span>\t<span class=\"literal\">False</span></span><br><span class=\"line\">d\t<span class=\"number\">2001</span>\tshanghai\t<span class=\"number\">2.4</span>\t<span class=\"number\">4</span>\t<span class=\"literal\">False</span></span><br><span class=\"line\">e\t<span class=\"number\">2002</span>\tshanghai\t<span class=\"number\">2.9</span>\t<span class=\"number\">5</span>\t<span class=\"literal\">False</span></span><br><span class=\"line\">f\t<span class=\"number\">2003</span>\tshanghai\t<span class=\"number\">3.2</span>\t<span class=\"number\">6</span>\t<span class=\"literal\">False</span></span><br><span class=\"line\">f2.T</span><br><span class=\"line\">a\tb\tc\td\te\tf</span><br><span class=\"line\">year\t<span class=\"number\">2000</span>\t<span class=\"number\">2001</span>\t<span class=\"number\">2002</span>\t<span class=\"number\">2001</span>\t<span class=\"number\">2002</span>\t<span class=\"number\">2003</span></span><br><span class=\"line\">state\tbeijing\tbeijing\tbeijign\tshanghai\tshanghai\tshanghai</span><br><span class=\"line\">pop\t<span class=\"number\">1.5</span>\t<span class=\"number\">1.7</span>\t<span class=\"number\">3.6</span>\t<span class=\"number\">2.4</span>\t<span class=\"number\">2.9</span>\t<span class=\"number\">3.2</span></span><br><span class=\"line\">debt\t<span class=\"number\">1</span>\t<span class=\"number\">2</span>\t<span class=\"number\">3</span>\t<span class=\"number\">4</span>\t<span class=\"number\">5</span>\t<span class=\"number\">6</span></span><br><span class=\"line\">new\t<span class=\"literal\">True</span>\t<span class=\"literal\">True</span>\t<span class=\"literal\">False</span>\t<span class=\"literal\">False</span>\t<span class=\"literal\">False</span>\t<span class=\"literal\">False</span></span><br><span class=\"line\">f2.index.name = <span class=\"string\">'order'</span>;f2.columns.name=<span class=\"string\">'key'</span></span><br><span class=\"line\">f2</span><br><span class=\"line\">key\tyear\tstate\tpop\tdebt\tnew</span><br><span class=\"line\">order\t\t\t\t\t</span><br><span class=\"line\">a\t<span class=\"number\">2000</span>\tbeijing\t<span class=\"number\">1.5</span>\t<span class=\"number\">1</span>\t<span class=\"literal\">True</span></span><br><span class=\"line\">b\t<span class=\"number\">2001</span>\tbeijing\t<span class=\"number\">1.7</span>\t<span class=\"number\">2</span>\t<span class=\"literal\">True</span></span><br><span class=\"line\">c\t<span class=\"number\">2002</span>\tbeijign\t<span class=\"number\">3.6</span>\t<span class=\"number\">3</span>\t<span class=\"literal\">False</span></span><br><span class=\"line\">d\t<span class=\"number\">2001</span>\tshanghai\t<span class=\"number\">2.4</span>\t<span class=\"number\">4</span>\t<span class=\"literal\">False</span></span><br><span class=\"line\">e\t<span class=\"number\">2002</span>\tshanghai\t<span class=\"number\">2.9</span>\t<span class=\"number\">5</span>\t<span class=\"literal\">False</span></span><br><span class=\"line\">f\t<span class=\"number\">2003</span>\tshanghai\t<span class=\"number\">3.2</span>\t<span class=\"number\">6</span>\t<span class=\"literal\">False</span></span><br><span class=\"line\">f2.values</span><br><span class=\"line\">array([[<span class=\"number\">2000</span>, <span class=\"string\">'beijing'</span>, <span class=\"number\">1.5</span>, <span class=\"number\">1</span>, <span class=\"literal\">True</span>],</span><br><span class=\"line\">       [<span class=\"number\">2001</span>, <span class=\"string\">'beijing'</span>, <span class=\"number\">1.7</span>, <span class=\"number\">2</span>, <span class=\"literal\">True</span>],</span><br><span class=\"line\">       [<span class=\"number\">2002</span>, <span class=\"string\">'beijign'</span>, <span class=\"number\">3.6</span>, <span class=\"number\">3</span>, <span class=\"literal\">False</span>],</span><br><span class=\"line\">       [<span class=\"number\">2001</span>, <span class=\"string\">'shanghai'</span>, <span class=\"number\">2.4</span>, <span class=\"number\">4</span>, <span class=\"literal\">False</span>],</span><br><span class=\"line\">       [<span class=\"number\">2002</span>, <span class=\"string\">'shanghai'</span>, <span class=\"number\">2.9</span>, <span class=\"number\">5</span>, <span class=\"literal\">False</span>],</span><br><span class=\"line\">       [<span class=\"number\">2003</span>, <span class=\"string\">'shanghai'</span>, <span class=\"number\">3.2</span>, <span class=\"number\">6</span>, <span class=\"literal\">False</span>]], dtype=object)</span><br><span class=\"line\">f2.info()</span><br><span class=\"line\">&lt;<span class=\"class\"><span class=\"keyword\">class</span> '<span class=\"title\">pandas</span>.<span class=\"title\">core</span>.<span class=\"title\">frame</span>.<span class=\"title\">DataFrame</span>'&gt;</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"title\">Index</span>:</span> <span class=\"number\">6</span> entries, a to f</span><br><span class=\"line\">Data columns (total <span class=\"number\">5</span> columns):</span><br><span class=\"line\"> <span class=\"comment\">#   Column  Non-Null Count  Dtype  </span></span><br><span class=\"line\">---  ------  --------------  -----  </span><br><span class=\"line\"> <span class=\"number\">0</span>   year    <span class=\"number\">6</span> non-null      int64  </span><br><span class=\"line\"> <span class=\"number\">1</span>   state   <span class=\"number\">6</span> non-null      object </span><br><span class=\"line\"> <span class=\"number\">2</span>   pop     <span class=\"number\">6</span> non-null      float64</span><br><span class=\"line\"> <span class=\"number\">3</span>   debt    <span class=\"number\">6</span> non-null      int32  </span><br><span class=\"line\"> <span class=\"number\">4</span>   new     <span class=\"number\">6</span> non-null      bool   </span><br><span class=\"line\">dtypes: bool(<span class=\"number\">1</span>), float64(<span class=\"number\">1</span>), int32(<span class=\"number\">1</span>), int64(<span class=\"number\">1</span>), object(<span class=\"number\">1</span>)</span><br><span class=\"line\">memory usage: <span class=\"number\">382.0</span>+ bytes</span><br><span class=\"line\">obj = pd.Series(range(<span class=\"number\">3</span>),index = [<span class=\"string\">'a'</span>,<span class=\"string\">'b'</span>,<span class=\"string\">'c'</span>])</span><br><span class=\"line\">obj</span><br><span class=\"line\">a    <span class=\"number\">0</span></span><br><span class=\"line\">b    <span class=\"number\">1</span></span><br><span class=\"line\">c    <span class=\"number\">2</span></span><br><span class=\"line\">dtype: int64</span><br><span class=\"line\">labels = pd.Index(np.arange(<span class=\"number\">3</span>))</span><br><span class=\"line\">labels</span><br><span class=\"line\">Int64Index([<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>], dtype=<span class=\"string\">'int64'</span>)</span><br><span class=\"line\">obj2 = pd.Series([<span class=\"number\">2</span>,<span class=\"number\">3.4</span>,<span class=\"number\">0</span>],index=labels)</span><br><span class=\"line\">obj2</span><br><span class=\"line\"><span class=\"number\">0</span>    <span class=\"number\">2.0</span></span><br><span class=\"line\"><span class=\"number\">1</span>    <span class=\"number\">3.4</span></span><br><span class=\"line\"><span class=\"number\">2</span>    <span class=\"number\">0.0</span></span><br><span class=\"line\">dtype: float64</span><br><span class=\"line\"><span class=\"string\">'c'</span> <span class=\"keyword\">in</span> f2.index</span><br><span class=\"line\"><span class=\"literal\">True</span></span><br><span class=\"line\"><span class=\"string\">'pop'</span> <span class=\"keyword\">in</span> f2.columns</span><br><span class=\"line\"><span class=\"literal\">True</span></span><br><span class=\"line\">dup_lables = pd.Index([<span class=\"string\">'foo'</span>,<span class=\"string\">'foo'</span>,<span class=\"string\">'bar'</span>,<span class=\"string\">'bar'</span>])</span><br><span class=\"line\">dup_lables</span><br><span class=\"line\">Index([<span class=\"string\">'foo'</span>, <span class=\"string\">'foo'</span>, <span class=\"string\">'bar'</span>, <span class=\"string\">'bar'</span>], dtype=<span class=\"string\">'object'</span>)</span><br><span class=\"line\"> obj=pd.Series([<span class=\"number\">4.5</span>,<span class=\"number\">7.2</span>,<span class=\"number\">-5.3</span>,<span class=\"number\">3.6</span>],index = [<span class=\"string\">'d'</span>,<span class=\"string\">'b'</span>,<span class=\"string\">'a'</span>,<span class=\"string\">'c'</span>])</span><br><span class=\"line\">obj</span><br><span class=\"line\">d    <span class=\"number\">4.5</span></span><br><span class=\"line\">b    <span class=\"number\">7.2</span></span><br><span class=\"line\">a   <span class=\"number\">-5.3</span></span><br><span class=\"line\">c    <span class=\"number\">3.6</span></span><br><span class=\"line\">dtype: float64</span><br><span class=\"line\"><span class=\"comment\"># 重建索引</span></span><br><span class=\"line\">obj2 = obj.reindex(list(<span class=\"string\">'abcde'</span>))</span><br><span class=\"line\">obj2</span><br><span class=\"line\">a   <span class=\"number\">-5.3</span></span><br><span class=\"line\">b    <span class=\"number\">7.2</span></span><br><span class=\"line\">c    <span class=\"number\">3.6</span></span><br><span class=\"line\">d    <span class=\"number\">4.5</span></span><br><span class=\"line\">e    NaN</span><br><span class=\"line\">dtype: float64</span><br><span class=\"line\">obj3 = pd.Series([<span class=\"string\">'blue'</span>,<span class=\"string\">'purple'</span>,<span class=\"string\">'yellow'</span>],index = [<span class=\"number\">0</span>,<span class=\"number\">2</span>,<span class=\"number\">4</span>])</span><br><span class=\"line\">obj3</span><br><span class=\"line\"><span class=\"number\">0</span>      blue</span><br><span class=\"line\"><span class=\"number\">2</span>    purple</span><br><span class=\"line\"><span class=\"number\">4</span>    yellow</span><br><span class=\"line\">dtype: object</span><br><span class=\"line\"><span class=\"comment\"># 用method方法填充缺失值</span></span><br><span class=\"line\"><span class=\"comment\"># ffill表示向前填充，bfill表示向后填充</span></span><br><span class=\"line\"><span class=\"comment\"># ffill将1的值填给2，bfill将2的值填给1</span></span><br><span class=\"line\">obj3.reindex(range(<span class=\"number\">6</span>),method=<span class=\"string\">'ffill'</span>)</span><br><span class=\"line\"><span class=\"number\">0</span>      blue</span><br><span class=\"line\"><span class=\"number\">1</span>      blue</span><br><span class=\"line\"><span class=\"number\">2</span>    purple</span><br><span class=\"line\"><span class=\"number\">3</span>    purple</span><br><span class=\"line\"><span class=\"number\">4</span>    yellow</span><br><span class=\"line\"><span class=\"number\">5</span>    yellow</span><br><span class=\"line\">dtype: object</span><br><span class=\"line\">obj3</span><br><span class=\"line\"><span class=\"number\">0</span>      blue</span><br><span class=\"line\"><span class=\"number\">2</span>    purple</span><br><span class=\"line\"><span class=\"number\">4</span>    yellow</span><br><span class=\"line\">dtype: object</span><br><span class=\"line\">obj3.reindex(range(<span class=\"number\">6</span>),method = <span class=\"string\">'bfill'</span>)</span><br><span class=\"line\"><span class=\"number\">0</span>      blue</span><br><span class=\"line\"><span class=\"number\">1</span>    purple</span><br><span class=\"line\"><span class=\"number\">2</span>    purple</span><br><span class=\"line\"><span class=\"number\">3</span>    yellow</span><br><span class=\"line\"><span class=\"number\">4</span>    yellow</span><br><span class=\"line\"><span class=\"number\">5</span>       NaN</span><br><span class=\"line\">dtype: object</span><br><span class=\"line\">f = pd.DataFrame(np.arange(<span class=\"number\">9</span>).reshape((<span class=\"number\">3</span>,<span class=\"number\">3</span>)),index=list(<span class=\"string\">'acd'</span>),columns=[<span class=\"string\">'beijing'</span>,<span class=\"string\">'shanghai'</span>,<span class=\"string\">'guangzhou'</span>])</span><br><span class=\"line\">f</span><br><span class=\"line\">beijing\tshanghai\tguangzhou</span><br><span class=\"line\">a\t<span class=\"number\">0</span>\t<span class=\"number\">1</span>\t<span class=\"number\">2</span></span><br><span class=\"line\">c\t<span class=\"number\">3</span>\t<span class=\"number\">4</span>\t<span class=\"number\">5</span></span><br><span class=\"line\">d\t<span class=\"number\">6</span>\t<span class=\"number\">7</span>\t<span class=\"number\">8</span></span><br><span class=\"line\"><span class=\"comment\"># 如果执行reindex方法时只提供一个列表参数，则默认是修改行索引。</span></span><br><span class=\"line\">f2 = f.reindex(list(<span class=\"string\">'abcd'</span>))</span><br><span class=\"line\">f2</span><br><span class=\"line\">beijing\tshanghai\tguangzhou</span><br><span class=\"line\">a\t<span class=\"number\">0.0</span>\t<span class=\"number\">1.0</span>\t<span class=\"number\">2.0</span></span><br><span class=\"line\">b\tNaN\tNaN\tNaN</span><br><span class=\"line\">c\t<span class=\"number\">3.0</span>\t<span class=\"number\">4.0</span>\t<span class=\"number\">5.0</span></span><br><span class=\"line\">d\t<span class=\"number\">6.0</span>\t<span class=\"number\">7.0</span>\t<span class=\"number\">8.0</span></span><br><span class=\"line\">f3 = f.reindex(columns=[<span class=\"string\">'beijing'</span>,<span class=\"string\">'shanghai'</span>,<span class=\"string\">'xian'</span>,<span class=\"string\">'guangzhou'</span>])</span><br><span class=\"line\">f3</span><br><span class=\"line\">beijing\tshanghai\txian\tguangzhou</span><br><span class=\"line\">a\t<span class=\"number\">0</span>\t<span class=\"number\">1</span>\tNaN\t<span class=\"number\">2</span></span><br><span class=\"line\">c\t<span class=\"number\">3</span>\t<span class=\"number\">4</span>\tNaN\t<span class=\"number\">5</span></span><br><span class=\"line\">d\t<span class=\"number\">6</span>\t<span class=\"number\">7</span>\tNaN\t<span class=\"number\">8</span></span><br><span class=\"line\">s = pd.Series(np.arange(<span class=\"number\">5</span>),index = list(<span class=\"string\">'abcde'</span>))</span><br><span class=\"line\">s</span><br><span class=\"line\">a    <span class=\"number\">0</span></span><br><span class=\"line\">b    <span class=\"number\">1</span></span><br><span class=\"line\">c    <span class=\"number\">2</span></span><br><span class=\"line\">d    <span class=\"number\">3</span></span><br><span class=\"line\">e    <span class=\"number\">4</span></span><br><span class=\"line\">dtype: int32</span><br><span class=\"line\">s.drop(<span class=\"string\">'c'</span>)</span><br><span class=\"line\">a    <span class=\"number\">0</span></span><br><span class=\"line\">b    <span class=\"number\">1</span></span><br><span class=\"line\">d    <span class=\"number\">3</span></span><br><span class=\"line\">e    <span class=\"number\">4</span></span><br><span class=\"line\">dtype: int32</span><br><span class=\"line\">df = pd.DataFrame(np.arange(<span class=\"number\">16</span>).reshape(<span class=\"number\">4</span>,<span class=\"number\">4</span>),columns=[<span class=\"string\">'one'</span>,<span class=\"string\">'two'</span>,<span class=\"string\">'three'</span>,<span class=\"string\">'four'</span>])</span><br><span class=\"line\">df</span><br><span class=\"line\">one\ttwo\tthree\tfour</span><br><span class=\"line\"><span class=\"number\">0</span>\t<span class=\"number\">0</span>\t<span class=\"number\">1</span>\t<span class=\"number\">2</span>\t<span class=\"number\">3</span></span><br><span class=\"line\"><span class=\"number\">1</span>\t<span class=\"number\">4</span>\t<span class=\"number\">5</span>\t<span class=\"number\">6</span>\t<span class=\"number\">7</span></span><br><span class=\"line\"><span class=\"number\">2</span>\t<span class=\"number\">8</span>\t<span class=\"number\">9</span>\t<span class=\"number\">10</span>\t<span class=\"number\">11</span></span><br><span class=\"line\"><span class=\"number\">3</span>\t<span class=\"number\">12</span>\t<span class=\"number\">13</span>\t<span class=\"number\">14</span>\t<span class=\"number\">15</span></span><br><span class=\"line\"><span class=\"comment\"># 删除行</span></span><br><span class=\"line\">df.drop(<span class=\"number\">2</span>)</span><br><span class=\"line\">one\ttwo\tthree\tfour</span><br><span class=\"line\"><span class=\"number\">0</span>\t<span class=\"number\">0</span>\t<span class=\"number\">1</span>\t<span class=\"number\">2</span>\t<span class=\"number\">3</span></span><br><span class=\"line\"><span class=\"number\">1</span>\t<span class=\"number\">4</span>\t<span class=\"number\">5</span>\t<span class=\"number\">6</span>\t<span class=\"number\">7</span></span><br><span class=\"line\"><span class=\"number\">3</span>\t<span class=\"number\">12</span>\t<span class=\"number\">13</span>\t<span class=\"number\">14</span>\t<span class=\"number\">15</span></span><br><span class=\"line\"><span class=\"comment\"># 删除列</span></span><br><span class=\"line\">df.drop(<span class=\"string\">'two'</span>,axis = <span class=\"number\">1</span>)</span><br><span class=\"line\">one\tthree\tfour</span><br><span class=\"line\"><span class=\"number\">0</span>\t<span class=\"number\">0</span>\t<span class=\"number\">2</span>\t<span class=\"number\">3</span></span><br><span class=\"line\"><span class=\"number\">1</span>\t<span class=\"number\">4</span>\t<span class=\"number\">6</span>\t<span class=\"number\">7</span></span><br><span class=\"line\"><span class=\"number\">2</span>\t<span class=\"number\">8</span>\t<span class=\"number\">10</span>\t<span class=\"number\">11</span></span><br><span class=\"line\"><span class=\"number\">3</span>\t<span class=\"number\">12</span>\t<span class=\"number\">14</span>\t<span class=\"number\">15</span></span><br><span class=\"line\"><span class=\"comment\"># 但此时df未发生变化</span></span><br><span class=\"line\">df</span><br><span class=\"line\">one\ttwo\tthree\tfour</span><br><span class=\"line\"><span class=\"number\">0</span>\t<span class=\"number\">0</span>\t<span class=\"number\">1</span>\t<span class=\"number\">2</span>\t<span class=\"number\">3</span></span><br><span class=\"line\"><span class=\"number\">1</span>\t<span class=\"number\">4</span>\t<span class=\"number\">5</span>\t<span class=\"number\">6</span>\t<span class=\"number\">7</span></span><br><span class=\"line\"><span class=\"number\">2</span>\t<span class=\"number\">8</span>\t<span class=\"number\">9</span>\t<span class=\"number\">10</span>\t<span class=\"number\">11</span></span><br><span class=\"line\"><span class=\"number\">3</span>\t<span class=\"number\">12</span>\t<span class=\"number\">13</span>\t<span class=\"number\">14</span>\t<span class=\"number\">15</span></span><br><span class=\"line\"><span class=\"comment\"># 要想df发生变化，就要使用inplace=true</span></span><br><span class=\"line\">df.drop(<span class=\"number\">2</span>,inplace=<span class=\"literal\">True</span>)</span><br><span class=\"line\">df</span><br><span class=\"line\">one\ttwo\tthree\tfour</span><br><span class=\"line\"><span class=\"number\">0</span>\t<span class=\"number\">0</span>\t<span class=\"number\">1</span>\t<span class=\"number\">2</span>\t<span class=\"number\">3</span></span><br><span class=\"line\"><span class=\"number\">1</span>\t<span class=\"number\">4</span>\t<span class=\"number\">5</span>\t<span class=\"number\">6</span>\t<span class=\"number\">7</span></span><br><span class=\"line\"><span class=\"number\">3</span>\t<span class=\"number\">12</span>\t<span class=\"number\">13</span>\t<span class=\"number\">14</span>\t<span class=\"number\">15</span></span><br><span class=\"line\">​</span><br><span class=\"line\"><span class=\"number\">0</span>     <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"number\">1</span>     <span class=\"number\">4</span></span><br><span class=\"line\"><span class=\"number\">3</span>    <span class=\"number\">12</span></span><br><span class=\"line\">Name: one, dtype: int32</span><br><span class=\"line\"><span class=\"comment\"># 在Series中，行df['0']</span></span><br><span class=\"line\"><span class=\"comment\"># 在DataFrame中，优先按列操作！</span></span><br><span class=\"line\"><span class=\"comment\"># 行df.loc[]</span></span><br><span class=\"line\">df = pd.DataFrame(np.arange(<span class=\"number\">16</span>).reshape(<span class=\"number\">4</span>,<span class=\"number\">4</span>),</span><br><span class=\"line\">index=list(<span class=\"string\">'abcd'</span>),columns=[<span class=\"string\">'one'</span>,<span class=\"string\">'two'</span>,<span class=\"string\">'three'</span>,<span class=\"string\">'four'</span>])</span><br><span class=\"line\">df</span><br><span class=\"line\">one\ttwo\tthree\tfour</span><br><span class=\"line\">a\t<span class=\"number\">0</span>\t<span class=\"number\">1</span>\t<span class=\"number\">2</span>\t<span class=\"number\">3</span></span><br><span class=\"line\">b\t<span class=\"number\">4</span>\t<span class=\"number\">5</span>\t<span class=\"number\">6</span>\t<span class=\"number\">7</span></span><br><span class=\"line\">c\t<span class=\"number\">8</span>\t<span class=\"number\">9</span>\t<span class=\"number\">10</span>\t<span class=\"number\">11</span></span><br><span class=\"line\">d\t<span class=\"number\">12</span>\t<span class=\"number\">13</span>\t<span class=\"number\">14</span>\t<span class=\"number\">15</span></span><br><span class=\"line\">df.loc[<span class=\"string\">'b'</span>, [<span class=\"string\">'two'</span>,<span class=\"string\">'four'</span>]]  <span class=\"comment\"># 使用显式索引值，用逗号分隔行和列参数</span></span><br><span class=\"line\">two     <span class=\"number\">5</span></span><br><span class=\"line\">four    <span class=\"number\">7</span></span><br><span class=\"line\">Name: b, dtype: int32</span><br><span class=\"line\">df.loc[<span class=\"string\">'b'</span>:, <span class=\"string\">'two'</span>:<span class=\"string\">'four'</span>]</span><br><span class=\"line\">two\tthree\tfour</span><br><span class=\"line\">b\t<span class=\"number\">5</span>\t<span class=\"number\">6</span>\t<span class=\"number\">7</span></span><br><span class=\"line\">c\t<span class=\"number\">9</span>\t<span class=\"number\">10</span>\t<span class=\"number\">11</span></span><br><span class=\"line\">d\t<span class=\"number\">13</span>\t<span class=\"number\">14</span>\t<span class=\"number\">15</span></span><br><span class=\"line\">df.iloc[<span class=\"number\">2</span>, [<span class=\"number\">3</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>]]  <span class=\"comment\"># 用隐含的整数索引检索，但是这个打印格式好别扭</span></span><br><span class=\"line\">four    <span class=\"number\">11</span></span><br><span class=\"line\">one      <span class=\"number\">8</span></span><br><span class=\"line\">two      <span class=\"number\">9</span></span><br><span class=\"line\">Name: c, dtype: int32</span><br><span class=\"line\">df1 = pd.DataFrame(np.arange(<span class=\"number\">9</span>).reshape(<span class=\"number\">3</span>,<span class=\"number\">3</span>),columns=list(<span class=\"string\">'bcd'</span>),index=[<span class=\"string\">'one'</span>,<span class=\"string\">'two'</span>,<span class=\"string\">'three'</span>])</span><br><span class=\"line\">df1</span><br><span class=\"line\">b\tc\td</span><br><span class=\"line\">one\t<span class=\"number\">0</span>\t<span class=\"number\">1</span>\t<span class=\"number\">2</span></span><br><span class=\"line\">two\t<span class=\"number\">3</span>\t<span class=\"number\">4</span>\t<span class=\"number\">5</span></span><br><span class=\"line\">three\t<span class=\"number\">6</span>\t<span class=\"number\">7</span>\t<span class=\"number\">8</span></span><br><span class=\"line\">df2 = pd.DataFrame(np.arange(<span class=\"number\">12</span>).reshape(<span class=\"number\">4</span>,<span class=\"number\">3</span>),columns=list(<span class=\"string\">'bde'</span>),index=[<span class=\"string\">'two'</span>,<span class=\"string\">'three'</span>,<span class=\"string\">'five'</span>,<span class=\"string\">'six'</span>])</span><br><span class=\"line\">df2</span><br><span class=\"line\">b\td\te</span><br><span class=\"line\">two\t<span class=\"number\">0</span>\t<span class=\"number\">1</span>\t<span class=\"number\">2</span></span><br><span class=\"line\">three\t<span class=\"number\">3</span>\t<span class=\"number\">4</span>\t<span class=\"number\">5</span></span><br><span class=\"line\">five\t<span class=\"number\">6</span>\t<span class=\"number\">7</span>\t<span class=\"number\">8</span></span><br><span class=\"line\">six\t<span class=\"number\">9</span>\t<span class=\"number\">10</span>\t<span class=\"number\">11</span></span><br><span class=\"line\"><span class=\"comment\"># 按索引加，没找到就是NaN</span></span><br><span class=\"line\">df1 + df2</span><br><span class=\"line\">b\tc\td\te</span><br><span class=\"line\">five\tNaN\tNaN\tNaN\tNaN</span><br><span class=\"line\">one\tNaN\tNaN\tNaN\tNaN</span><br><span class=\"line\">six\tNaN\tNaN\tNaN\tNaN</span><br><span class=\"line\">three\t<span class=\"number\">9.0</span>\tNaN\t<span class=\"number\">12.0</span>\tNaN</span><br><span class=\"line\">two\t<span class=\"number\">3.0</span>\tNaN\t<span class=\"number\">6.0</span>\tNaN</span><br><span class=\"line\"><span class=\"comment\"># 为了防止NaN对后续的影响，进行填充</span></span><br><span class=\"line\"><span class=\"comment\"># 如果某一方有值，另一方没有的话，将没有的那方的值填充为指定的参数值。</span></span><br><span class=\"line\"><span class=\"comment\"># 而不是在最终结果中，将所有的NaN替换为填充值。</span></span><br><span class=\"line\">df1.add(df2,fill_value=<span class=\"number\">0</span>)</span><br><span class=\"line\">b\tc\td\te</span><br><span class=\"line\">five\t<span class=\"number\">6.0</span>\tNaN\t<span class=\"number\">7.0</span>\t<span class=\"number\">8.0</span></span><br><span class=\"line\">one\t<span class=\"number\">0.0</span>\t<span class=\"number\">1.0</span>\t<span class=\"number\">2.0</span>\tNaN</span><br><span class=\"line\">six\t<span class=\"number\">9.0</span>\tNaN\t<span class=\"number\">10.0</span>\t<span class=\"number\">11.0</span></span><br><span class=\"line\">three\t<span class=\"number\">9.0</span>\t<span class=\"number\">7.0</span>\t<span class=\"number\">12.0</span>\t<span class=\"number\">5.0</span></span><br><span class=\"line\">two\t<span class=\"number\">3.0</span>\t<span class=\"number\">4.0</span>\t<span class=\"number\">6.0</span>\t<span class=\"number\">2.0</span></span><br><span class=\"line\">df1.reindex(columns=df2.columns, fill_value=<span class=\"number\">0</span>) <span class=\"comment\"># 也可以这么干</span></span><br><span class=\"line\">b\td\te</span><br><span class=\"line\">one\t<span class=\"number\">0</span>\t<span class=\"number\">2</span>\t<span class=\"number\">0</span></span><br><span class=\"line\">two\t<span class=\"number\">3</span>\t<span class=\"number\">5</span>\t<span class=\"number\">0</span></span><br><span class=\"line\">three\t<span class=\"number\">6</span>\t<span class=\"number\">8</span>\t<span class=\"number\">0</span></span><br><span class=\"line\">​</span><br><span class=\"line\">b\td\te</span><br><span class=\"line\">one\t<span class=\"number\">0</span>\t<span class=\"number\">1</span>\t<span class=\"number\">2</span></span><br><span class=\"line\">two\t<span class=\"number\">3</span>\t<span class=\"number\">4</span>\t<span class=\"number\">5</span></span><br><span class=\"line\">three\t<span class=\"number\">6</span>\t<span class=\"number\">7</span>\t<span class=\"number\">8</span></span><br><span class=\"line\">four\t<span class=\"number\">9</span>\t<span class=\"number\">10</span>\t<span class=\"number\">11</span></span><br><span class=\"line\">df = pd.DataFrame(np.random.randn(<span class=\"number\">4</span>,<span class=\"number\">3</span>), columns=list(<span class=\"string\">'bde'</span>),index = [<span class=\"string\">'one'</span>,<span class=\"string\">'two'</span>,<span class=\"string\">'three'</span>,<span class=\"string\">'four'</span>])</span><br><span class=\"line\">f = <span class=\"keyword\">lambda</span> x: x.max() - x.min()</span><br><span class=\"line\">df</span><br><span class=\"line\">b\td\te</span><br><span class=\"line\">one\t<span class=\"number\">-1.238968</span>\t<span class=\"number\">-0.555044</span>\t<span class=\"number\">0.484394</span></span><br><span class=\"line\">two\t<span class=\"number\">1.034252</span>\t<span class=\"number\">-0.568455</span>\t<span class=\"number\">0.638041</span></span><br><span class=\"line\">three\t<span class=\"number\">1.247979</span>\t<span class=\"number\">-0.220433</span>\t<span class=\"number\">0.781580</span></span><br><span class=\"line\">four\t<span class=\"number\">1.736475</span>\t<span class=\"number\">0.318916</span>\t<span class=\"number\">1.718611</span></span><br><span class=\"line\">df.apply(f)</span><br><span class=\"line\">b    <span class=\"number\">2.975442</span></span><br><span class=\"line\">d    <span class=\"number\">0.887371</span></span><br><span class=\"line\">e    <span class=\"number\">1.234217</span></span><br><span class=\"line\">dtype: float64</span><br><span class=\"line\"><span class=\"comment\"># 可以指定按行应用f，只需要设置axis='columns'</span></span><br><span class=\"line\">df.apply(f, axis=<span class=\"string\">'columns'</span>)</span><br><span class=\"line\">one      <span class=\"number\">1.723362</span></span><br><span class=\"line\">two      <span class=\"number\">1.602707</span></span><br><span class=\"line\">three    <span class=\"number\">1.468412</span></span><br><span class=\"line\">four     <span class=\"number\">1.417559</span></span><br><span class=\"line\">dtype: float64</span><br><span class=\"line\"><span class=\"comment\"># 排序</span></span><br><span class=\"line\">s = pd.Series(range(<span class=\"number\">4</span>),index = list(<span class=\"string\">'dabc'</span>))</span><br><span class=\"line\">s</span><br><span class=\"line\">d    <span class=\"number\">0</span></span><br><span class=\"line\">a    <span class=\"number\">1</span></span><br><span class=\"line\">b    <span class=\"number\">2</span></span><br><span class=\"line\">c    <span class=\"number\">3</span></span><br><span class=\"line\">dtype: int64</span><br><span class=\"line\">s.sort_index() <span class=\"comment\"># 根据索引的字母序列排序</span></span><br><span class=\"line\">a    <span class=\"number\">1</span></span><br><span class=\"line\">b    <span class=\"number\">2</span></span><br><span class=\"line\">c    <span class=\"number\">3</span></span><br><span class=\"line\">d    <span class=\"number\">0</span></span><br><span class=\"line\">dtype: int64</span><br><span class=\"line\">df = pd.DataFrame(np.random.randint(<span class=\"number\">10</span>,size=(<span class=\"number\">4</span>,<span class=\"number\">3</span>)), columns=list(<span class=\"string\">'edb'</span>),index = [<span class=\"string\">'two'</span>,<span class=\"string\">'one'</span>,<span class=\"string\">'five'</span>,<span class=\"string\">'four'</span>])</span><br><span class=\"line\">df</span><br><span class=\"line\">e\td\tb</span><br><span class=\"line\">two\t<span class=\"number\">0</span>\t<span class=\"number\">7</span>\t<span class=\"number\">4</span></span><br><span class=\"line\">one\t<span class=\"number\">4</span>\t<span class=\"number\">4</span>\t<span class=\"number\">0</span></span><br><span class=\"line\">five\t<span class=\"number\">9</span>\t<span class=\"number\">3</span>\t<span class=\"number\">7</span></span><br><span class=\"line\">four\t<span class=\"number\">3</span>\t<span class=\"number\">5</span>\t<span class=\"number\">3</span></span><br><span class=\"line\">df.sort_index() <span class=\"comment\"># 默认按行索引排序，并以字母顺序</span></span><br><span class=\"line\">e\td\tb</span><br><span class=\"line\">five\t<span class=\"number\">9</span>\t<span class=\"number\">3</span>\t<span class=\"number\">7</span></span><br><span class=\"line\">four\t<span class=\"number\">3</span>\t<span class=\"number\">5</span>\t<span class=\"number\">3</span></span><br><span class=\"line\">one\t<span class=\"number\">4</span>\t<span class=\"number\">4</span>\t<span class=\"number\">0</span></span><br><span class=\"line\">two\t<span class=\"number\">0</span>\t<span class=\"number\">7</span>\t<span class=\"number\">4</span></span><br><span class=\"line\">df.sort_index(axis=<span class=\"number\">1</span>)  <span class=\"comment\"># 按列排序</span></span><br><span class=\"line\">b\td\te</span><br><span class=\"line\">two\t<span class=\"number\">4</span>\t<span class=\"number\">7</span>\t<span class=\"number\">0</span></span><br><span class=\"line\">one\t<span class=\"number\">0</span>\t<span class=\"number\">4</span>\t<span class=\"number\">4</span></span><br><span class=\"line\">five\t<span class=\"number\">7</span>\t<span class=\"number\">3</span>\t<span class=\"number\">9</span></span><br><span class=\"line\">four\t<span class=\"number\">3</span>\t<span class=\"number\">5</span>\t<span class=\"number\">3</span></span><br><span class=\"line\">df.sort_index(axis=<span class=\"number\">1</span>,ascending=<span class=\"literal\">False</span>)  <span class=\"comment\"># 默认升序，可以指定为倒序</span></span><br><span class=\"line\">e\td\tb</span><br><span class=\"line\">two\t<span class=\"number\">0</span>\t<span class=\"number\">7</span>\t<span class=\"number\">4</span></span><br><span class=\"line\">one\t<span class=\"number\">4</span>\t<span class=\"number\">4</span>\t<span class=\"number\">0</span></span><br><span class=\"line\">five\t<span class=\"number\">9</span>\t<span class=\"number\">3</span>\t<span class=\"number\">7</span></span><br><span class=\"line\">four\t<span class=\"number\">3</span>\t<span class=\"number\">5</span>\t<span class=\"number\">3</span></span><br><span class=\"line\">s= pd.Series([<span class=\"number\">4</span>, <span class=\"number\">7</span>,<span class=\"number\">-3</span>,<span class=\"number\">2</span>])</span><br><span class=\"line\">s</span><br><span class=\"line\"><span class=\"number\">0</span>    <span class=\"number\">4</span></span><br><span class=\"line\"><span class=\"number\">1</span>    <span class=\"number\">7</span></span><br><span class=\"line\"><span class=\"number\">2</span>   <span class=\"number\">-3</span></span><br><span class=\"line\"><span class=\"number\">3</span>    <span class=\"number\">2</span></span><br><span class=\"line\">dtype: int64</span><br><span class=\"line\"><span class=\"comment\"># np.nan缺失值会自动排到最后</span></span><br><span class=\"line\">s.sort_values()</span><br><span class=\"line\"><span class=\"number\">2</span>   <span class=\"number\">-3</span></span><br><span class=\"line\"><span class=\"number\">3</span>    <span class=\"number\">2</span></span><br><span class=\"line\"><span class=\"number\">0</span>    <span class=\"number\">4</span></span><br><span class=\"line\"><span class=\"number\">1</span>    <span class=\"number\">7</span></span><br><span class=\"line\">dtype: int64</span><br><span class=\"line\">df2 = pd.DataFrame(&#123;<span class=\"string\">'b'</span>:[<span class=\"number\">4</span>,<span class=\"number\">7</span>,<span class=\"number\">-3</span>,<span class=\"number\">2</span>], <span class=\"string\">'a'</span>:[<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">0</span>,<span class=\"number\">1</span>]&#125;)</span><br><span class=\"line\">df2</span><br><span class=\"line\">b\ta</span><br><span class=\"line\"><span class=\"number\">0</span>\t<span class=\"number\">4</span>\t<span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"number\">1</span>\t<span class=\"number\">7</span>\t<span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"number\">2</span>\t<span class=\"number\">-3</span>\t<span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"number\">3</span>\t<span class=\"number\">2</span>\t<span class=\"number\">1</span></span><br><span class=\"line\"> <span class=\"comment\"># 根据某一列里的元素值进行排序</span></span><br><span class=\"line\">df2.sort_values(by=<span class=\"string\">'b'</span>)</span><br><span class=\"line\">b\ta</span><br><span class=\"line\"><span class=\"number\">2</span>\t<span class=\"number\">-3</span>\t<span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"number\">3</span>\t<span class=\"number\">2</span>\t<span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"number\">0</span>\t<span class=\"number\">4</span>\t<span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"number\">1</span>\t<span class=\"number\">7</span>\t<span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"comment\"># 根据某些列进行排序</span></span><br><span class=\"line\">df2.sort_values(by=[<span class=\"string\">'a'</span>,<span class=\"string\">'b'</span>]) </span><br><span class=\"line\">b\ta</span><br><span class=\"line\"><span class=\"number\">2</span>\t<span class=\"number\">-3</span>\t<span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"number\">0</span>\t<span class=\"number\">4</span>\t<span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"number\">3</span>\t<span class=\"number\">2</span>\t<span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"number\">1</span>\t<span class=\"number\">7</span>\t<span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"comment\"># 除了排序，还有排名。Pandas的排名规则不太好理解，其规则如下：</span></span><br><span class=\"line\">​</span><br><span class=\"line\"><span class=\"comment\"># 以升序排名为例</span></span><br><span class=\"line\"><span class=\"comment\"># 所有数中最小的数排为1.0</span></span><br><span class=\"line\"><span class=\"comment\"># 按数大小依此类推，2.0、3.0、4.0给安排位次</span></span><br><span class=\"line\"><span class=\"comment\"># 如果有重复的数，则重复的排名相加除以重复的个数，得出一个排名</span></span><br><span class=\"line\"><span class=\"comment\"># 重复的数后面的排名，接着排</span></span><br><span class=\"line\">s = pd.Series([<span class=\"number\">7</span>,<span class=\"number\">-5</span>,<span class=\"number\">7</span>,<span class=\"number\">4</span>,<span class=\"number\">2</span>,<span class=\"number\">0</span>,<span class=\"number\">4</span>])</span><br><span class=\"line\">s</span><br><span class=\"line\"><span class=\"number\">0</span>    <span class=\"number\">7</span></span><br><span class=\"line\"><span class=\"number\">1</span>   <span class=\"number\">-5</span></span><br><span class=\"line\"><span class=\"number\">2</span>    <span class=\"number\">7</span></span><br><span class=\"line\"><span class=\"number\">3</span>    <span class=\"number\">4</span></span><br><span class=\"line\"><span class=\"number\">4</span>    <span class=\"number\">2</span></span><br><span class=\"line\"><span class=\"number\">5</span>    <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"number\">6</span>    <span class=\"number\">4</span></span><br><span class=\"line\">dtype: int64</span><br><span class=\"line\"><span class=\"comment\"># -5最小，所以第二名排1.0</span></span><br><span class=\"line\">s.rank()</span><br><span class=\"line\"><span class=\"number\">0</span>    <span class=\"number\">6.5</span></span><br><span class=\"line\"><span class=\"number\">1</span>    <span class=\"number\">1.0</span></span><br><span class=\"line\"><span class=\"number\">2</span>    <span class=\"number\">6.5</span></span><br><span class=\"line\"><span class=\"number\">3</span>    <span class=\"number\">4.5</span></span><br><span class=\"line\"><span class=\"number\">4</span>    <span class=\"number\">3.0</span></span><br><span class=\"line\"><span class=\"number\">5</span>    <span class=\"number\">2.0</span></span><br><span class=\"line\"><span class=\"number\">6</span>    <span class=\"number\">4.5</span></span><br><span class=\"line\">dtype: float64</span><br><span class=\"line\">s.rank(method=<span class=\"string\">'first'</span>)</span><br><span class=\"line\"><span class=\"number\">0</span>    <span class=\"number\">6.0</span></span><br><span class=\"line\"><span class=\"number\">1</span>    <span class=\"number\">1.0</span></span><br><span class=\"line\"><span class=\"number\">2</span>    <span class=\"number\">7.0</span></span><br><span class=\"line\"><span class=\"number\">3</span>    <span class=\"number\">4.0</span></span><br><span class=\"line\"><span class=\"number\">4</span>    <span class=\"number\">3.0</span></span><br><span class=\"line\"><span class=\"number\">5</span>    <span class=\"number\">2.0</span></span><br><span class=\"line\"><span class=\"number\">6</span>    <span class=\"number\">5.0</span></span><br><span class=\"line\">dtype: float64</span><br><span class=\"line\">s.rank(method=<span class=\"string\">'max'</span>,ascending=<span class=\"literal\">False</span>)</span><br><span class=\"line\"><span class=\"number\">0</span>    <span class=\"number\">2.0</span></span><br><span class=\"line\"><span class=\"number\">1</span>    <span class=\"number\">7.0</span></span><br><span class=\"line\"><span class=\"number\">2</span>    <span class=\"number\">2.0</span></span><br><span class=\"line\"><span class=\"number\">3</span>    <span class=\"number\">4.0</span></span><br><span class=\"line\"><span class=\"number\">4</span>    <span class=\"number\">5.0</span></span><br><span class=\"line\"><span class=\"number\">5</span>    <span class=\"number\">6.0</span></span><br><span class=\"line\"><span class=\"number\">6</span>    <span class=\"number\">4.0</span></span><br><span class=\"line\">dtype: float64</span><br><span class=\"line\"> df = pd.DataFrame(np.random.randint(<span class=\"number\">-10</span>,<span class=\"number\">10</span>,(<span class=\"number\">4</span>,<span class=\"number\">3</span>)),columns=list(<span class=\"string\">'abc'</span>))</span><br><span class=\"line\"> df   </span><br><span class=\"line\">a\tb\tc</span><br><span class=\"line\"><span class=\"number\">0</span>\t<span class=\"number\">-7</span>\t<span class=\"number\">5</span>\t<span class=\"number\">-3</span></span><br><span class=\"line\"><span class=\"number\">1</span>\t<span class=\"number\">-10</span>\t<span class=\"number\">5</span>\t<span class=\"number\">-8</span></span><br><span class=\"line\"><span class=\"number\">2</span>\t<span class=\"number\">3</span>\t<span class=\"number\">-1</span>\t<span class=\"number\">9</span></span><br><span class=\"line\"><span class=\"number\">3</span>\t<span class=\"number\">3</span>\t<span class=\"number\">-5</span>\t<span class=\"number\">-6</span></span><br><span class=\"line\">df.rank(axis=<span class=\"string\">'columns'</span>)</span><br><span class=\"line\">a\tb\tc</span><br><span class=\"line\"><span class=\"number\">0</span>\t<span class=\"number\">1.0</span>\t<span class=\"number\">3.0</span>\t<span class=\"number\">2.0</span></span><br><span class=\"line\"><span class=\"number\">1</span>\t<span class=\"number\">1.0</span>\t<span class=\"number\">3.0</span>\t<span class=\"number\">2.0</span></span><br><span class=\"line\"><span class=\"number\">2</span>\t<span class=\"number\">2.0</span>\t<span class=\"number\">1.0</span>\t<span class=\"number\">3.0</span></span><br><span class=\"line\"><span class=\"number\">3</span>\t<span class=\"number\">3.0</span>\t<span class=\"number\">2.0</span>\t<span class=\"number\">1.0</span></span><br><span class=\"line\">df = pd.DataFrame([[<span class=\"number\">1.4</span>, np.nan],[<span class=\"number\">7.1</span>,<span class=\"number\">-4.2</span>],[np.nan,np.nan],[<span class=\"number\">0.75</span>,<span class=\"number\">-1.1</span>]],index=list(<span class=\"string\">'abcd'</span>),columns=[<span class=\"string\">'one'</span>,<span class=\"string\">'two'</span>])</span><br><span class=\"line\">df</span><br><span class=\"line\">one\ttwo</span><br><span class=\"line\">a\t<span class=\"number\">1.40</span>\tNaN</span><br><span class=\"line\">b\t<span class=\"number\">7.10</span>\t<span class=\"number\">-4.2</span></span><br><span class=\"line\">c\tNaN\tNaN</span><br><span class=\"line\">d\t<span class=\"number\">0.75</span>\t<span class=\"number\">-1.1</span></span><br><span class=\"line\"><span class=\"comment\"># 默认对列进行求和，并返回一个Series对象，缺失值默认被忽略</span></span><br><span class=\"line\">df.sum() </span><br><span class=\"line\">one    <span class=\"number\">9.25</span></span><br><span class=\"line\">two   <span class=\"number\">-5.30</span></span><br><span class=\"line\">dtype: float64</span><br><span class=\"line\"><span class=\"comment\"># 对行进行求和</span></span><br><span class=\"line\">df.sum(axis=<span class=\"string\">'columns'</span>) </span><br><span class=\"line\">a    <span class=\"number\">1.40</span></span><br><span class=\"line\">b    <span class=\"number\">2.90</span></span><br><span class=\"line\">c    <span class=\"number\">0.00</span></span><br><span class=\"line\">d   <span class=\"number\">-0.35</span></span><br><span class=\"line\">dtype: float64</span><br><span class=\"line\"> <span class=\"comment\"># 对行求平均值，但不忽略缺失值</span></span><br><span class=\"line\">df.mean(axis=<span class=\"string\">'columns'</span>, skipna=<span class=\"literal\">False</span>)</span><br><span class=\"line\">a      NaN</span><br><span class=\"line\">b    <span class=\"number\">1.450</span></span><br><span class=\"line\">c      NaN</span><br><span class=\"line\">d   <span class=\"number\">-0.175</span></span><br><span class=\"line\">dtype: float64</span><br><span class=\"line\">df</span><br><span class=\"line\">one\ttwo</span><br><span class=\"line\">a\t<span class=\"number\">1.40</span>\tNaN</span><br><span class=\"line\">b\t<span class=\"number\">7.10</span>\t<span class=\"number\">-4.2</span></span><br><span class=\"line\">c\tNaN\tNaN</span><br><span class=\"line\">d\t<span class=\"number\">0.75</span>\t<span class=\"number\">-1.1</span></span><br><span class=\"line\"><span class=\"comment\"># count 统计非NaN的个数</span></span><br><span class=\"line\">df.describe()</span><br><span class=\"line\">one\ttwo</span><br><span class=\"line\">count\t<span class=\"number\">3.000000</span>\t<span class=\"number\">2.000000</span></span><br><span class=\"line\">mean\t<span class=\"number\">3.083333</span>\t<span class=\"number\">-2.650000</span></span><br><span class=\"line\">std\t<span class=\"number\">3.493685</span>\t<span class=\"number\">2.192031</span></span><br><span class=\"line\">min\t<span class=\"number\">0.750000</span>\t<span class=\"number\">-4.200000</span></span><br><span class=\"line\"><span class=\"number\">25</span>%\t<span class=\"number\">1.075000</span>\t<span class=\"number\">-3.425000</span></span><br><span class=\"line\"><span class=\"number\">50</span>%\t<span class=\"number\">1.400000</span>\t<span class=\"number\">-2.650000</span></span><br><span class=\"line\"><span class=\"number\">75</span>%\t<span class=\"number\">4.250000</span>\t<span class=\"number\">-1.875000</span></span><br><span class=\"line\">max\t<span class=\"number\">7.100000</span>\t<span class=\"number\">-1.100000</span></span><br><span class=\"line\">s=pd.Series(list(<span class=\"string\">'aabc'</span>*<span class=\"number\">4</span>))</span><br><span class=\"line\">s</span><br><span class=\"line\"><span class=\"number\">0</span>     a</span><br><span class=\"line\"><span class=\"number\">1</span>     a</span><br><span class=\"line\"><span class=\"number\">2</span>     b</span><br><span class=\"line\"><span class=\"number\">3</span>     c</span><br><span class=\"line\"><span class=\"number\">4</span>     a</span><br><span class=\"line\"><span class=\"number\">5</span>     a</span><br><span class=\"line\"><span class=\"number\">6</span>     b</span><br><span class=\"line\"><span class=\"number\">7</span>     c</span><br><span class=\"line\"><span class=\"number\">8</span>     a</span><br><span class=\"line\"><span class=\"number\">9</span>     a</span><br><span class=\"line\"><span class=\"number\">10</span>    b</span><br><span class=\"line\"><span class=\"number\">11</span>    c</span><br><span class=\"line\"><span class=\"number\">12</span>    a</span><br><span class=\"line\"><span class=\"number\">13</span>    a</span><br><span class=\"line\"><span class=\"number\">14</span>    b</span><br><span class=\"line\"><span class=\"number\">15</span>    c</span><br><span class=\"line\">dtype: object</span><br><span class=\"line\"> <span class=\"comment\"># 对于非数值型，统计类型不一样</span></span><br><span class=\"line\">s.describe()  </span><br><span class=\"line\">count     <span class=\"number\">16</span></span><br><span class=\"line\">unique     <span class=\"number\">3</span></span><br><span class=\"line\">top        a</span><br><span class=\"line\">freq       <span class=\"number\">8</span></span><br><span class=\"line\">dtype: object</span><br><span class=\"line\"><span class=\"comment\"># unique：计算唯一值数组，并按观察顺序返回</span></span><br><span class=\"line\"><span class=\"comment\"># value_counts:计数，并按多到少排序</span></span><br><span class=\"line\"><span class=\"comment\"># isin：判断是否包含成员</span></span><br><span class=\"line\">s = pd.Series(list(<span class=\"string\">'cadaabbcc'</span>))</span><br><span class=\"line\">s</span><br><span class=\"line\"><span class=\"number\">0</span>    c</span><br><span class=\"line\"><span class=\"number\">1</span>    a</span><br><span class=\"line\"><span class=\"number\">2</span>    d</span><br><span class=\"line\"><span class=\"number\">3</span>    a</span><br><span class=\"line\"><span class=\"number\">4</span>    a</span><br><span class=\"line\"><span class=\"number\">5</span>    b</span><br><span class=\"line\"><span class=\"number\">6</span>    b</span><br><span class=\"line\"><span class=\"number\">7</span>    c</span><br><span class=\"line\"><span class=\"number\">8</span>    c</span><br><span class=\"line\">dtype: object</span><br><span class=\"line\"><span class=\"comment\"># 获取去重后的值</span></span><br><span class=\"line\">uniques = s.unique() </span><br><span class=\"line\">uniques</span><br><span class=\"line\">array([<span class=\"string\">'c'</span>, <span class=\"string\">'a'</span>, <span class=\"string\">'d'</span>, <span class=\"string\">'b'</span>], dtype=object)</span><br><span class=\"line\"><span class=\"comment\"># 计数，默认从多到少排序</span></span><br><span class=\"line\">s.value_counts() </span><br><span class=\"line\">c    <span class=\"number\">3</span></span><br><span class=\"line\">a    <span class=\"number\">3</span></span><br><span class=\"line\">b    <span class=\"number\">2</span></span><br><span class=\"line\">d    <span class=\"number\">1</span></span><br><span class=\"line\">dtype: int64</span><br><span class=\"line\">pd.value_counts(s, sort=<span class=\"literal\">False</span>) <span class=\"comment\"># 也可以这么调用，并且不排序</span></span><br><span class=\"line\">d    <span class=\"number\">1</span></span><br><span class=\"line\">a    <span class=\"number\">3</span></span><br><span class=\"line\">b    <span class=\"number\">2</span></span><br><span class=\"line\">c    <span class=\"number\">3</span></span><br><span class=\"line\">dtype: int64</span><br><span class=\"line\"><span class=\"comment\"># 判断Series的元素在不在b和c里面</span></span><br><span class=\"line\">mask = s.isin([<span class=\"string\">'b'</span>,<span class=\"string\">'c'</span>]) </span><br><span class=\"line\">mask</span><br><span class=\"line\"><span class=\"number\">0</span>     <span class=\"literal\">True</span></span><br><span class=\"line\"><span class=\"number\">1</span>    <span class=\"literal\">False</span></span><br><span class=\"line\"><span class=\"number\">2</span>    <span class=\"literal\">False</span></span><br><span class=\"line\"><span class=\"number\">3</span>    <span class=\"literal\">False</span></span><br><span class=\"line\"><span class=\"number\">4</span>    <span class=\"literal\">False</span></span><br><span class=\"line\"><span class=\"number\">5</span>     <span class=\"literal\">True</span></span><br><span class=\"line\"><span class=\"number\">6</span>     <span class=\"literal\">True</span></span><br><span class=\"line\"><span class=\"number\">7</span>     <span class=\"literal\">True</span></span><br><span class=\"line\"><span class=\"number\">8</span>     <span class=\"literal\">True</span></span><br><span class=\"line\">dtype: bool</span><br><span class=\"line\">s[mask]</span><br><span class=\"line\"><span class=\"number\">0</span>    c</span><br><span class=\"line\"><span class=\"number\">5</span>    b</span><br><span class=\"line\"><span class=\"number\">6</span>    b</span><br><span class=\"line\"><span class=\"number\">7</span>    c</span><br><span class=\"line\"><span class=\"number\">8</span>    c</span><br><span class=\"line\">dtype: object</span><br></pre></td></tr></table></figure>\n\n","categories":[{"name":"数据分析","slug":"数据分析","count":2,"path":"api/categories/数据分析.json"}],"tags":[{"name":"Pandas","slug":"Pandas","count":1,"path":"api/tags/Pandas.json"}]}